<!DOCTYPE html><html>
 <head>
  <meta charset="utf-8">
  </meta>
  <title>
   Varuna Jayasiri
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </meta>
  <meta name="apple-mobile-web-app-capable" content="yes">
  </meta>
  <link href="http://fonts.googleapis.com/css?family=Raleway:400,100,200,300,500,600,700,800,900" rel="stylesheet" type="text/css">
  </link>
  <link href="lib/skeleton/css/skeleton.css" rel="stylesheet">
  </link>
  <link href="lib/highlightjs/styles/default.css" rel="stylesheet">
  </link>
  <link href="css/style.css" rel="stylesheet">
  </link>
  <link href="css/paginate.css" rel="stylesheet">
  </link>
  <link href="blog.css" rel="stylesheet">
  </link>
  <script>
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-44255805-1', 'auto');
ga('send', 'pageview');
  </script>
 </head>
 <body>
  <div class="container wallapatta-container ">
   <div class="header ">
    <h1>
     <a href="index.html">
      VARUNA JAYASIRI
     </a>
    </h1>
    <a class="button " href="https://www.twitter.com/vpj">
     @vpj
    </a>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="facebook.html">
      We stopped advertising on Facebook
     </a>
    </h1>
    <h3 class="date ">
     December 30, 2013
    </h3>
    <div class="post-paginated ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_0" class="article"><div id="wallapatta_1" class="section"><h3 class="heading"><span id="wallapatta_2" class="block"><span id="wallapatta_42" class="text">Or, How to get Facebook "likes"?</span></span></h3><div class="content"></div></div><div id="wallapatta_6" class="section"><div class="content"><p id="wallapatta_7" class="paragraph"><a id="wallapatta_45" class="link" href="http://www.nearby.lk">nearby.lk</a><span id="wallapatta_46" class="text"> stopped advertising on Facebook to get Facebook "likes", because we felt that it was a giant fruitless scheme of making Facebook rich. Most of the "likes" on Facebook are useless, they are basically random clicks, which adds no value to anybody, and you need to pay Facebook for that. By the way, this may not be the case with advertising for *Clicks to Website*, *Website Conversions*, etc. - I don't have experience with those.</span></p></div></div><div id="wallapatta_8" class="section"><div class="content"><p id="wallapatta_9" class="paragraph"><a id="wallapatta_47" class="link" href="https://www.facebook.com/www.nearby.lk">We got on Facebook</a><span id="wallapatta_48" class="text"> when one of our employees created a fan page for the company, which we later made our official page. Facebook advertising was important for us to get awareness and to build reputation - so that our clients know we are popular because a lot of people like us on Facebook.</span></p></div></div><div id="wallapatta_10" class="section"><div class="content"><p id="wallapatta_11" class="paragraph"><span id="wallapatta_49" class="text">It didn't take us long to realize that the first goal is never met because we got almost no traffic to </span><a id="wallapatta_50" class="link" href="http://www.nearby.lk">nearby.lk</a><span id="wallapatta_51" class="text"> from Facebook; it was way lower than the number of likes we were getting. What we expected was the other way around - lots people visiting the site and a few "liking" us. </span><strong id="wallapatta_52" class="bold"><span id="wallapatta_53" class="text">"Like" never meant like, it meant click.</span></strong><span id="wallapatta_54" class="text"> People who "liked" probably didn't even know what they clicked, so it didn't do any marketing for us. Also, more "likes" didn't mean that there was a large set of users who would see our updates, since most of these people have liked hundreds of pages.</span></p></div></div><div id="wallapatta_12" class="section"><div class="content"><p id="wallapatta_13" class="paragraph"><span id="wallapatta_55" class="text">Our second goal, building a reputation, a public available figure to show we are popular, was met. And it still works, because most people don't know how Facebook "likes" work. </span><strong id="wallapatta_56" class="bold"><span id="wallapatta_57" class="text">They believe we have a lot of likes because we have a great product and people like it. But there's absolutely no dwirelationship between the two.</span></strong></p></div></div><div id="wallapatta_14" class="section"><div class="content"><p id="wallapatta_15" class="paragraph"><span id="wallapatta_58" class="text">State Department has spent $630,000 on Facebook</span><sup id="wallapatta_59" class="superScript"><span id="wallapatta_60" class="text">1, 2</span></sup><span id="wallapatta_61" class="text">.</span></p><div id="wallapatta_21" class="special"><div id="wallapatta_22" class="section"><div class="content"><p id="wallapatta_23" class="paragraph"><span id="wallapatta_70" class="text">"Many in the bureau criticize the advertising campaigns as ‘buying fans' who may have once clicked on an ad or ‘liked' a photo but have no real interest in the topic and have never engaged further," reads the Inspector General report.</span></p></div></div></div></div></div><div id="wallapatta_24" class="section"><div class="content"><p id="wallapatta_25" class="paragraph"><em id="wallapatta_71" class="italics"><span id="wallapatta_72" class="text">At least they got their "likes" from homeland.</span></em></p></div></div><div id="wallapatta_26" class="section"><div class="content"><p id="wallapatta_27" class="paragraph"><span id="wallapatta_73" class="text">When we launched a prototype </span><a id="wallapatta_74" class="link" href="http://www.nearby.in">nearby.in</a><span id="wallapatta_75" class="text"> with attractions in India, we advertised on Facebook targeting India. With a bit of research while doing that, we realized how most companies in Sri Lanka, which has almost nothing to do with foreign countries, get Facebook likes from countries other than Sri Lanka. They simply advertise targeting other countries, especially developing countries with large populations. And it is cheaper.</span></p></div></div><div id="wallapatta_31" class="section"><div class="content"><p id="wallapatta_32" class="paragraph"><span id="wallapatta_79" class="text">For instance the page </span><a id="wallapatta_80" class="link" href="https://www.facebook.com/FYI.SriLanka">FYI - Sri Lanka Mobile Directory</a><span id="wallapatta_81" class="text"> probably, as its name implies, has nothing to do with Turkey.</span></p></div></div><div id="wallapatta_33" class="image-container"><img class="image" src="http://vpj.github.io/images/posts/fb/city.png" alt="http://vpj.github.io/images/posts/fb/city.png"></div><div id="wallapatta_34" class="section"><div class="content"><p id="wallapatta_35" class="paragraph"><span id="wallapatta_82" class="text">Not all companies are stupid enough to let others see their likes are useless. They spread it among a number of countries, while putting a little extra advertising in homeland, so that the most popular country remains to be homeland. To see how they do it you need to go create an ad yourself.</span></p></div></div><div id="wallapatta_39" class="image-container"><img class="image" src="http://vpj.github.io/images/posts/fb/ad.png" alt="http://vpj.github.io/images/posts/fb/ad.png"></div><div id="wallapatta_40" class="section"><div class="content"><p id="wallapatta_41" class="paragraph"><span id="wallapatta_84" class="text">So it's all about a race to get more </span><em id="wallapatta_85" class="italics"><span id="wallapatta_86" class="text">likes</span></em><span id="wallapatta_87" class="text">, not creating a product that people </span><em id="wallapatta_88" class="italics"><span id="wallapatta_89" class="text">like</span></em><span id="wallapatta_90" class="text">. And since these are not genuine likes, number of likes in Facebook becomes just a figure of how much money you can waste on Facebook; that is exchanging your money for Facebook "likes" which has no meaning.</span></p></div></div></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      <div id="wallapatta_3" class="sidenote"><div id="wallapatta_4" class="section"><div class="content"><p id="wallapatta_5" class="paragraph"><strong id="wallapatta_43" class="bold"><a id="wallapatta_44" class="link" href="https://news.ycombinator.com/item?id=7036205">Hacker News discussion</a></strong></p></div></div></div><div id="wallapatta_16" class="sidenote"><div id="wallapatta_17" class="section"><div class="content"><p id="wallapatta_18" class="paragraph"><sup id="wallapatta_62" class="superScript"><span id="wallapatta_63" class="text">1</span></sup><span id="wallapatta_64" class="text"> </span><a id="wallapatta_65" class="link" href="http://thecable.foreignpolicy.com/posts/2013/07/02/omg_state_department_dropped_630000_on_facebook_likes">foreignpolicy.com</a></p></div></div><div id="wallapatta_19" class="section"><div class="content"><p id="wallapatta_20" class="paragraph"><sup id="wallapatta_66" class="superScript"><span id="wallapatta_67" class="text">2</span></sup><span id="wallapatta_68" class="text"> </span><a id="wallapatta_69" class="link" href="http://washingtonexaminer.com/article/2532629">washingtonexaminer.com</a></p></div></div></div><div id="wallapatta_28" class="sidenote"><div id="wallapatta_29" class="section"><div class="content"><p id="wallapatta_30" class="paragraph"><span id="wallapatta_76" class="text">We didn't work on </span><a id="wallapatta_77" class="link" href="http://www.nearby.in">nearby.in</a><span id="wallapatta_78" class="text"> after launch, it still running our old system.</span></p></div></div></div><div id="wallapatta_36" class="sidenote"><div id="wallapatta_37" class="section"><div class="content"><p id="wallapatta_38" class="paragraph"><span id="wallapatta_83" class="text">I'm not sure how accurate the figures provided by Facebook are, but I'm guessing it should be at least approximately correct.*</span></p></div></div></div>
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>###Or, How to get Facebook "likes"?

 &gt;&gt;&gt;
  **&lt;&lt;https://news.ycombinator.com/item?id=7036205(Hacker News discussion)&gt;&gt;

&lt;&lt;http://www.nearby.lk(nearby.lk)&gt;&gt; stopped advertising on Facebook to get Facebook "likes", because we felt that it was a giant fruitless scheme of making Facebook rich. Most of the "likes" on Facebook are useless, they are basically random clicks, which adds no value to anybody, and you need to pay Facebook for that. By the way, this may not be the case with advertising for *Clicks to Website*, *Website Conversions*, etc. - I don't have experience with those.

&lt;&lt;https://www.facebook.com/www.nearby.lk(We got on Facebook)&gt;&gt; when one of our employees created a fan page for the company, which we later made our official page. Facebook advertising was important for us to get awareness and to build reputation - so that our clients know we are popular because a lot of people like us on Facebook.

It didn't take us long to realize that the first goal is never met because we got almost no traffic to &lt;&lt;http://www.nearby.lk(nearby.lk&gt;&gt; from Facebook; it was way lower than the number of likes we were getting. What we expected was the other way around - lots people visiting the site and a few "liking" us. **"Like" never meant like, it meant click.** People who "liked" probably didn't even know what they clicked, so it didn't do any marketing for us. Also, more "likes" didn't mean that there was a large set of users who would see our updates, since most of these people have liked hundreds of pages.

Our second goal, building a reputation, a public available figure to show we are popular, was met. And it still works, because most people don't know how Facebook "likes" work. **They believe we have a lot of likes because we have a great product and people like it. But there's absolutely no dwirelationship between the two.**

State Department has spent $630,000 on Facebook^^1, 2^^.

 &gt;&gt;&gt;
  ^^1^^ &lt;&lt;http://thecable.foreignpolicy.com/posts/2013/07/02/omg_state_department_dropped_630000_on_facebook_likes(foreignpolicy.com)&gt;&gt;

  ^^2^^ &lt;&lt;http://washingtonexaminer.com/article/2532629(washingtonexaminer.com)&gt;&gt;

 +++
  "Many in the bureau criticize the advertising campaigns as ‘buying fans' who may have once clicked on an ad or ‘liked' a photo but have no real interest in the topic and have never engaged further," reads the Inspector General report.


--At least they got their "likes" from homeland.

When we launched a prototype &lt;&lt;http://www.nearby.in(nearby.in)&gt;&gt; with attractions in India, we advertised on Facebook targeting India. With a bit of research while doing that, we realized how most companies in Sri Lanka, which has almost nothing to do with foreign countries, get Facebook likes from countries other than Sri Lanka. They simply advertise targeting other countries, especially developing countries with large populations. And it is cheaper.

 &gt;&gt;&gt;
  We didn't work on &lt;&lt;http://www.nearby.in(nearby.in)&gt;&gt; after launch, it still running our old system.

For instance the page &lt;&lt;https://www.facebook.com/FYI.SriLanka(FYI - Sri Lanka Mobile Directory)&gt;&gt; probably, as its name implies, has nothing to do with Turkey.

!http://vpj.github.io/images/posts/fb/city.png

Not all companies are stupid enough to let others see their likes are useless. They spread it among a number of countries, while putting a little extra advertising in homeland, so that the most popular country remains to be homeland. To see how they do it you need to go create an ad yourself.

 &gt;&gt;&gt;
  I'm not sure how accurate the figures provided by Facebook are, but I'm guessing it should be at least approximately correct.*

!http://vpj.github.io/images/posts/fb/ad.png

So it's all about a race to get more --likes--, not creating a product that people --like--. And since these are not genuine likes, number of likes in Facebook becomes just a figure of how much money you can waste on Facebook; that is exchanging your money for Facebook "likes" which has no meaning.
</div>
     </div>
     <div class="overlay ">
      
     </div>
    </div>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="d3_helpers.html">
      Coffeescript helpers for d3.js
     </a>
    </h1>
    <h3 class="date ">
     December 28, 2013
    </h3>
    <div class="post-paginated ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_10000" class="article"><div id="wallapatta_10001" class="section"><div class="content"><p id="wallapatta_10002" class="paragraph"><a id="wallapatta_10020" class="link" href="https://github.com/vpj/FP">fp.js</a><span id="wallapatta_10021" class="text"> is a tiny library to help keep </span><a id="wallapatta_10022" class="link" href="http://d3js.org/">d3.js</a><span id="wallapatta_10023" class="text"> dom manipulation code clean.</span></p></div></div><div id="wallapatta_10008" class="section"><div class="content"><p id="wallapatta_10009" class="paragraph"><span id="wallapatta_10031" class="text">I write a lot of d3.js code and most dom manipulation code got complicated and hard to maintain. With fp.js attributes, styles and events can be set easily. But the most important fact is that FP.js lets you maintain indentation in coffescript code that matches the dom structure.</span></p></div></div><pre id="wallapatta_10010" class="codeBlock"><code class="coffeescript">numbers = [<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">23</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">25</span>, <span class="hljs-number">11</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>]
chartHeight = <span class="hljs-number">300</span>

chart = d3.select(<span class="hljs-string">"body"</span>)
 .append(<span class="hljs-string">"svg"</span>)
 .attr(<span class="hljs-string">"width"</span>, <span class="hljs-string">"100%"</span>)
 .attr(<span class="hljs-string">"height"</span>, <span class="hljs-string">"100%"</span>)

bars = chart.selectAll(<span class="hljs-string">"g.bar"</span>).data(numbers).enter()
 .append(<span class="hljs-string">"g"</span>)
 .attr(<span class="hljs-string">"class"</span>, <span class="hljs-string">"bar"</span>)

bars.append(<span class="hljs-string">"rect"</span>)
 .attr(<span class="hljs-string">"y"</span>, <span class="hljs-function"><span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">10</span>)
 .attr(<span class="hljs-string">"x"</span>, <span class="hljs-function"><span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span>)
 .attr(<span class="hljs-string">"width"</span>, <span class="hljs-number">20</span>)
 .attr(<span class="hljs-string">"height"</span>, <span class="hljs-function"><span class="hljs-params">(d)</span> -&gt;</span> d * <span class="hljs-number">10</span>)

bars.append(<span class="hljs-string">"line"</span>)
 .attr(<span class="hljs-string">"class"</span>, <span class="hljs-string">"budget"</span>)
 .attr(<span class="hljs-string">"y1"</span>, <span class="hljs-function"><span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">9</span>)
 .attr(<span class="hljs-string">"y2"</span>, <span class="hljs-function"><span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">9</span>)
 .attr(<span class="hljs-string">"x1"</span>, <span class="hljs-function"><span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span>)
 .attr(<span class="hljs-string">"x2"</span>, <span class="hljs-function"><span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span> + <span class="hljs-number">20</span>)
 .attr(<span class="hljs-string">"stroke"</span>, <span class="hljs-function"><span class="hljs-params">(d)</span> -&gt;</span> <span class="hljs-keyword">if</span> d &lt; <span class="hljs-number">20</span> <span class="hljs-keyword">then</span> <span class="hljs-string">"white"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"#aaa"</span>)</code></pre><div id="wallapatta_10011" class="section"><div class="content"><p id="wallapatta_10012" class="paragraph"><span id="wallapatta_10032" class="text">Above is plain code to draw a simple bar chart with d3.js, and below is the code with FP.js.</span></p></div></div><pre id="wallapatta_10013" class="codeBlock"><code class="coffeescript">numbers = [<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">23</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">25</span>, <span class="hljs-number">11</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>]
chartHeight = <span class="hljs-number">300</span>

FP d3, <span class="hljs-string">'select'</span>, <span class="hljs-string">'body'</span>, <span class="hljs-function">-&gt;</span>
 FP @, <span class="hljs-string">'svg'</span>, <span class="hljs-attribute">width</span>: <span class="hljs-string">"100%"</span>, <span class="hljs-attribute">height</span>: <span class="hljs-string">"100%"</span>, <span class="hljs-function">-&gt;</span>
   FP @, <span class="hljs-string">'selectAll'</span>, <span class="hljs-string">'g.bar'</span>, <span class="hljs-function">-&gt;</span>
    FP @, <span class="hljs-string">'data'</span>, numbers, <span class="hljs-function">-&gt;</span>
     FP @, <span class="hljs-string">'enter'</span>, <span class="hljs-function">-&gt;</span>
      FP @, <span class="hljs-string">'g.bar'</span>, <span class="hljs-function">-&gt;</span>
       FP @, <span class="hljs-string">'rect'</span>,
        <span class="hljs-attribute">y</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">10</span>)
        <span class="hljs-attribute">x</span>: <span class="hljs-function">(<span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span>)
        <span class="hljs-attribute">width</span>: <span class="hljs-number">20</span>, <span class="hljs-attribute">height</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> d * <span class="hljs-number">10</span>)
       FP @, <span class="hljs-string">'line.budget'</span>,
        <span class="hljs-attribute">y1</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">9</span>)
        <span class="hljs-attribute">y2</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">9</span>)
        <span class="hljs-attribute">x1</span>: <span class="hljs-function">(<span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span>)
        <span class="hljs-attribute">x2</span>: <span class="hljs-function">(<span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span> + <span class="hljs-number">20</span>)
        <span class="hljs-attribute">stroke</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> <span class="hljs-keyword">if</span> d &lt; <span class="hljs-number">20</span> <span class="hljs-keyword">then</span> <span class="hljs-string">"white"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"#aaa"</span>)</code></pre><div id="wallapatta_10014" class="section"><div class="content"><p id="wallapatta_10015" class="paragraph"><span id="wallapatta_10033" class="text">I am planning to remove the clutter of </span><code id="wallapatta_10034" class="code"><span id="wallapatta_10035" class="text">FP @</span></code><span id="wallapatta_10036" class="text">, so that it'll look like the following; but for that I will have to either use `with` keyword or create functions for </span><code id="wallapatta_10037" class="code"><span id="wallapatta_10038" class="text">select</span></code><span id="wallapatta_10039" class="text">, </span><code id="wallapatta_10040" class="code"><span id="wallapatta_10041" class="text">rect</span></code><span id="wallapatta_10042" class="text">, </span><code id="wallapatta_10043" class="code"><span id="wallapatta_10044" class="text">line</span></code><span id="wallapatta_10045" class="text">, etc, in a local context similar to </span><a id="wallapatta_10046" class="link" href="https://github.com/mauricemach/coffeekup/blob/master/src/coffeekup.coffee">coffeekup</a><span id="wallapatta_10047" class="text">.</span></p></div></div><pre id="wallapatta_10016" class="codeBlock"><code class="coffeescript">FP d3, <span class="hljs-function">-&gt;</span>
 select <span class="hljs-string">'body'</span>, <span class="hljs-function">-&gt;</span>
  svg <span class="hljs-attribute">width</span>: <span class="hljs-string">"100%"</span>, <span class="hljs-attribute">height</span>: <span class="hljs-string">"100%"</span>, <span class="hljs-function">-&gt;</span>
    selectAll <span class="hljs-string">'g.bar'</span>, <span class="hljs-function">-&gt;</span>
     data numbers, <span class="hljs-function">-&gt;</span>
      enter -&gt;
       g <span class="hljs-string">'.bar'</span>, <span class="hljs-function">-&gt;</span>
        rect
         <span class="hljs-attribute">y</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">10</span>)
         <span class="hljs-attribute">x</span>: <span class="hljs-function">(<span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span>)
         <span class="hljs-attribute">width</span>: <span class="hljs-number">20</span>, <span class="hljs-attribute">height</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> d * <span class="hljs-number">10</span>)
        line <span class="hljs-string">'.budget'</span>,
         <span class="hljs-attribute">y1</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">9</span>)
         <span class="hljs-attribute">y2</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">9</span>)
         <span class="hljs-attribute">x1</span>: <span class="hljs-function">(<span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span>)
         <span class="hljs-attribute">x2</span>: <span class="hljs-function">(<span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span> + <span class="hljs-number">20</span>)
         <span class="hljs-attribute">stroke</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> <span class="hljs-keyword">if</span> d &lt; <span class="hljs-number">20</span> <span class="hljs-keyword">then</span> <span class="hljs-string">"white"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"#aaa"</span>)</code></pre><div id="wallapatta_10017" class="section"><div class="content"><p id="wallapatta_10018" class="paragraph"><span id="wallapatta_10048" class="text">Another option is to use </span><code id="wallapatta_10049" class="code"><span id="wallapatta_10050" class="text">@</span></code><span id="wallapatta_10051" class="text">, which cleaner and not that messy, but code readers might get confused whether </span><code id="wallapatta_10052" class="code"><span id="wallapatta_10053" class="text">@</span></code><span id="wallapatta_10054" class="text"> is referring to the object you are making the call from. Also, using a one letter name such as </span><strong id="wallapatta_10055" class="bold"><span id="wallapatta_10056" class="text">$</span></strong><span id="wallapatta_10057" class="text"> or </span><code id="wallapatta_10058" class="code"><span id="wallapatta_10059" class="text">_</span></code><span id="wallapatta_10060" class="text"> for fp.js will give a similar code - </span><code id="wallapatta_10061" class="code"><span id="wallapatta_10062" class="text">$.rect</span></code><span id="wallapatta_10063" class="text">, </span><code id="wallapatta_10064" class="code"><span id="wallapatta_10065" class="text">$.line</span></code><span id="wallapatta_10066" class="text">, etc.</span></p></div></div><pre id="wallapatta_10019" class="codeBlock"><code class="coffeescript">FP d3, <span class="hljs-function">-&gt;</span>
 <span class="hljs-property">@select</span> <span class="hljs-string">'body'</span>, <span class="hljs-function">-&gt;</span>
  <span class="hljs-property">@svg</span> <span class="hljs-attribute">width</span>: <span class="hljs-string">"100%"</span>, <span class="hljs-attribute">height</span>: <span class="hljs-string">"100%"</span>, <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@selectAll</span> <span class="hljs-string">'g.bar'</span>, <span class="hljs-function">-&gt;</span>
     <span class="hljs-property">@data</span> numbers, <span class="hljs-function">-&gt;</span>
      <span class="hljs-property">@enter</span> -&gt;
       <span class="hljs-property">@g</span> <span class="hljs-string">'.bar'</span>, <span class="hljs-function">-&gt;</span>
        <span class="hljs-property">@rect</span>
         <span class="hljs-attribute">y</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">10</span>)
         <span class="hljs-attribute">x</span>: <span class="hljs-function">(<span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span>)
         <span class="hljs-attribute">width</span>: <span class="hljs-number">20</span>, <span class="hljs-attribute">height</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> d * <span class="hljs-number">10</span>)
        <span class="hljs-property">@line</span> <span class="hljs-string">'.budget'</span>,
         <span class="hljs-attribute">y1</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">9</span>)
         <span class="hljs-attribute">y2</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> chartHeight - d * <span class="hljs-number">9</span>)
         <span class="hljs-attribute">x1</span>: <span class="hljs-function">(<span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span>)
         <span class="hljs-attribute">x2</span>: <span class="hljs-function">(<span class="hljs-params">(d, i)</span> -&gt;</span> i * <span class="hljs-number">20</span> + <span class="hljs-number">20</span>)
         <span class="hljs-attribute">stroke</span>: <span class="hljs-function">(<span class="hljs-params">(d)</span> -&gt;</span> <span class="hljs-keyword">if</span> d &lt; <span class="hljs-number">20</span> <span class="hljs-keyword">then</span> <span class="hljs-string">"white"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"#aaa"</span>)</code></pre></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      <div id="wallapatta_10003" class="sidenote"><div id="wallapatta_10004" class="section"><div class="content"><p id="wallapatta_10005" class="paragraph"><strong id="wallapatta_10024" class="bold"><span id="wallapatta_10025" class="text">Update (December 29, 2013)</span></strong></p></div></div><div id="wallapatta_10006" class="section"><div class="content"><p id="wallapatta_10007" class="paragraph"><span id="wallapatta_10026" class="text">Upgraded to support the format at the bottom. Check out </span><a id="wallapatta_10027" class="link" href="http://bl.ocks.org/vpj/8168794">this</a><span id="wallapatta_10028" class="text"> rewrite of the d3.js </span><a id="wallapatta_10029" class="link" href="http://bl.ocks.org/mbostock/3887051">Grouped Bar Chart Example</a><span id="wallapatta_10030" class="text"> using fp.js.</span></p></div></div></div>
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>///Coffeescript helpers for d3.js

&lt;&lt;https://github.com/vpj/FP(fp.js)&gt;&gt; is a tiny library to help keep &lt;&lt;http://d3js.org/(d3.js)&gt;&gt; dom manipulation code clean.

&gt;&gt;&gt;
 **Update (December 29, 2013)

 Upgraded to support the format at the bottom. Check out &lt;&lt;http://bl.ocks.org/vpj/8168794(this)&gt;&gt; rewrite of the d3.js &lt;&lt;http://bl.ocks.org/mbostock/3887051(Grouped Bar Chart Example)&gt;&gt; using fp.js.

I write a lot of d3.js code and most dom manipulation code got complicated and hard to maintain. With fp.js attributes, styles and events can be set easily. But the most important fact is that FP.js lets you maintain indentation in coffescript code that matches the dom structure.

```coffeescript
 numbers = [5, 3, 23, 6, 7, 0, 1, 25, 11, 19, 20]
 chartHeight = 300

 chart = d3.select("body")
  .append("svg")
  .attr("width", "100%")
  .attr("height", "100%")

 bars = chart.selectAll("g.bar").data(numbers).enter()
  .append("g")
  .attr("class", "bar")

 bars.append("rect")
  .attr("y", (d) -&gt; chartHeight - d * 10)
  .attr("x", (d, i) -&gt; i * 20)
  .attr("width", 20)
  .attr("height", (d) -&gt; d * 10)

 bars.append("line")
  .attr("class", "budget")
  .attr("y1", (d) -&gt; chartHeight - d * 9)
  .attr("y2", (d) -&gt; chartHeight - d * 9)
  .attr("x1", (d, i) -&gt; i * 20)
  .attr("x2", (d, i) -&gt; i * 20 + 20)
  .attr("stroke", (d) -&gt; if d &lt; 20 then "white" else "#aaa")

Above is plain code to draw a simple bar chart with d3.js, and below is the code with FP.js.

```coffeescript
 numbers = [5, 3, 23, 6, 7, 0, 1, 25, 11, 19, 20]
 chartHeight = 300

 FP d3, 'select', 'body', -&gt;
  FP @, 'svg', width: "100%", height: "100%", -&gt;
    FP @, 'selectAll', 'g.bar', -&gt;
     FP @, 'data', numbers, -&gt;
      FP @, 'enter', -&gt;
       FP @, 'g.bar', -&gt;
        FP @, 'rect',
         y: ((d) -&gt; chartHeight - d * 10)
         x: ((d, i) -&gt; i * 20)
         width: 20, height: ((d) -&gt; d * 10)
        FP @, 'line.budget',
         y1: ((d) -&gt; chartHeight - d * 9)
         y2: ((d) -&gt; chartHeight - d * 9)
         x1: ((d, i) -&gt; i * 20)
         x2: ((d, i) -&gt; i * 20 + 20)
         stroke: ((d) -&gt; if d &lt; 20 then "white" else "#aaa")

I am planning to remove the clutter of ``FP @``, so that it'll look like the following; but for that I will have to either use `with` keyword or create functions for ``select``, ``rect``, ``line``, etc, in a local context similar to &lt;&lt;https://github.com/mauricemach/coffeekup/blob/master/src/coffeekup.coffee(coffeekup)&gt;&gt;.

```coffeescript
 FP d3, -&gt;
  select 'body', -&gt;
   svg width: "100%", height: "100%", -&gt;
     selectAll 'g.bar', -&gt;
      data numbers, -&gt;
       enter -&gt;
        g '.bar', -&gt;
         rect
          y: ((d) -&gt; chartHeight - d * 10)
          x: ((d, i) -&gt; i * 20)
          width: 20, height: ((d) -&gt; d * 10)
         line '.budget',
          y1: ((d) -&gt; chartHeight - d * 9)
          y2: ((d) -&gt; chartHeight - d * 9)
          x1: ((d, i) -&gt; i * 20)
          x2: ((d, i) -&gt; i * 20 + 20)
          stroke: ((d) -&gt; if d &lt; 20 then "white" else "#aaa")

Another option is to use ``@``, which cleaner and not that messy, but code readers might get confused whether ``@`` is referring to the object you are making the call from. Also, using a one letter name such as **$** or ``_`` for fp.js will give a similar code - ``$.rect``, ``$.line``, etc.

```coffeescript
 FP d3, -&gt;
  @select 'body', -&gt;
   @svg width: "100%", height: "100%", -&gt;
     @selectAll 'g.bar', -&gt;
      @data numbers, -&gt;
       @enter -&gt;
        @g '.bar', -&gt;
         @rect
          y: ((d) -&gt; chartHeight - d * 10)
          x: ((d, i) -&gt; i * 20)
          width: 20, height: ((d) -&gt; d * 10)
         @line '.budget',
          y1: ((d) -&gt; chartHeight - d * 9)
          y2: ((d) -&gt; chartHeight - d * 9)
          x1: ((d, i) -&gt; i * 20)
          x2: ((d, i) -&gt; i * 20 + 20)
          stroke: ((d) -&gt; if d &lt; 20 then "white" else "#aaa")
</div>
     </div>
     <div class="overlay ">
      
     </div>
    </div>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="underline.html">
      Visualize data tables with variable length underlines
     </a>
    </h1>
    <h3 class="date ">
     December 23, 2013
    </h3>
    <div class="post-paginated ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_20000" class="article"><div id="wallapatta_20001" class="section"><div class="content"><p id="wallapatta_20002" class="paragraph"><span id="wallapatta_20037" class="text">Underline doesn't take away space in a table or a list of data and by varying the length of the underline you can help readers scan much faster and get an idea of the data and its distribution without having to read each number.</span></p></div></div><div id="wallapatta_20003" class="section"><h2 class="heading"><span id="wallapatta_20004" class="block"><span id="wallapatta_20038" class="text">List</span></span></h2><div class="content"><div id="wallapatta_20007" class="section"><div class="content"><p id="wallapatta_20008" class="paragraph"><span id="wallapatta_20039" class="text">The simplest and often the best way to show a list of numbesr is to simply list them.</span></p></div></div><div id="wallapatta_20009" class="section"><div class="content"><p id="wallapatta_20010" class="paragraph"><span id="wallapatta_20040" class="text">However, if the reader is to find the largest value she might have to go through each number, especially if all of them have the same number of digits. Sorting by the value will help, but it doesn't work if it's on a table that is sorted by some other figure.</span></p></div></div><div id="wallapatta_20011" class="section"><div class="content"><p id="wallapatta_20012" class="paragraph"><span id="wallapatta_20041" class="text">The line height of the list in the above figure can be reduced but a similar height can be found in most software, including spreadsheets and popular BI.</span></p></div></div></div></div><div id="wallapatta_20013" class="section"><h2 class="heading"><span id="wallapatta_20014" class="block"><span id="wallapatta_20042" class="text">Bars</span></span></h2><div class="content"><div id="wallapatta_20017" class="section"><div class="content"><p id="wallapatta_20018" class="paragraph"><span id="wallapatta_20043" class="text">Adding a bar, like a horizontal bar chart, helps you clearly identify the largest value, as well as get an understanding of the distribution without having to go through the numbers.</span></p></div></div><div id="wallapatta_20019" class="section"><div class="content"><p id="wallapatta_20020" class="paragraph"><span id="wallapatta_20044" class="text">But it's taking up a lot of space - at least another column width or more if you want to make it aesthetically pleasing. Another problem is that it might distract someone trying to read through the numbers; of course, choosing a more subtle color will help in that.</span></p></div></div><div id="wallapatta_20021" class="section"><div class="content"><p id="wallapatta_20022" class="paragraph"><span id="wallapatta_20045" class="text">Displaying text over bars reduces the space, but it makes it lot harder to read the numbers.</span></p></div></div></div></div><div id="wallapatta_20025" class="section"><h2 class="heading"><span id="wallapatta_20026" class="block"><span id="wallapatta_20046" class="text">Underline</span></span></h2><div class="content"><div id="wallapatta_20029" class="section"><div class="content"><p id="wallapatta_20030" class="paragraph"><span id="wallapatta_20047" class="text">Decreasing the height of the bar to a few pixels, or even a single pixel can still give the same effect as bars. Also, you can place them underneath the numbers so that it doesn't take up an extra column.</span></p></div></div><div id="wallapatta_20031" class="section"><div class="content"><p id="wallapatta_20032" class="paragraph"><span id="wallapatta_20048" class="text">Right aligning the bars takes away the cluttered feeling.  Again, choosing a more subtle color and/or reducing the thickness of the lines will help reduce the highlighting effect.</span></p></div></div><div id="wallapatta_20035" class="section"><div class="content"><p id="wallapatta_20036" class="paragraph"><span id="wallapatta_20049" class="text">The scale could be linear or logarithmic. A small axis could be place at the column heading to stop readers from misinterpreting.</span></p></div></div></div></div></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      <div id="wallapatta_20005" class="sidenote"><div id="wallapatta_20006" class="image-container"><img class="image" src="img/underline/list.png" alt="list" style="max-width: 50%;"></div></div><div id="wallapatta_20015" class="sidenote"><div id="wallapatta_20016" class="image-container"><img class="image" src="img/underline/bars.png" alt="bars" style="max-width: 70%;"></div></div><div id="wallapatta_20023" class="sidenote"><div id="wallapatta_20024" class="image-container"><img class="image" src="img/underline/bars-text.png" alt="bars with text" style="max-width: 60%;"></div></div><div id="wallapatta_20027" class="sidenote"><div id="wallapatta_20028" class="image-container"><img class="image" src="img/underline/underline-left.png" alt="underline left" style="max-width: 50%;"></div></div><div id="wallapatta_20033" class="sidenote"><div id="wallapatta_20034" class="image-container"><img class="image" src="img/underline/underline.png" alt="underline" style="max-width: 50%;"></div></div>
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>Underline doesn't take away space in a table or a list of data and by varying the length of the underline you can help readers scan much faster and get an idea of the data and its distribution without having to read each number.

##List
 &gt;&gt;&gt;
  !img/underline/list.png(list)(50)

 The simplest and often the best way to show a list of numbesr is to simply list them.

 However, if the reader is to find the largest value she might have to go through each number, especially if all of them have the same number of digits. Sorting by the value will help, but it doesn't work if it's on a table that is sorted by some other figure.

 The line height of the list in the above figure can be reduced but a similar height can be found in most software, including spreadsheets and popular BI.

##Bars
 &gt;&gt;&gt;
  !img/underline/bars.png(bars)(70)

 Adding a bar, like a horizontal bar chart, helps you clearly identify the largest value, as well as get an understanding of the distribution without having to go through the numbers.

 But it's taking up a lot of space - at least another column width or more if you want to make it aesthetically pleasing. Another problem is that it might distract someone trying to read through the numbers; of course, choosing a more subtle color will help in that.

 Displaying text over bars reduces the space, but it makes it lot harder to read the numbers.

 &gt;&gt;&gt;
  !img/underline/bars-text.png(bars with text)(60)

##Underline
 &gt;&gt;&gt;
  !img/underline/underline-left.png(underline left)(50)

 Decreasing the height of the bar to a few pixels, or even a single pixel can still give the same effect as bars. Also, you can place them underneath the numbers so that it doesn't take up an extra column.

 Right aligning the bars takes away the cluttered feeling.  Again, choosing a more subtle color and/or reducing the thickness of the lines will help reduce the highlighting effect.

 &gt;&gt;&gt;
  !img/underline/underline.png(underline)(50)

 The scale could be linear or logarithmic. A small axis could be place at the column heading to stop readers from misinterpreting.

</div>
     </div>
     <div class="overlay ">
      
     </div>
    </div>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="sweetjs.html">
      Another JS Framework
     </a>
    </h1>
    <h3 class="date ">
     December 17, 2013
    </h3>
    <div class="post-paginated ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_30000" class="article"><div id="wallapatta_30001" class="section"><div class="content"><p id="wallapatta_30002" class="paragraph"><span id="wallapatta_30021" class="text">I started working on </span><strong id="wallapatta_30022" class="bold"><a id="wallapatta_30023" class="link" href="https://github.com/vpj/sweet">Sweet.js</a></strong><span id="wallapatta_30024" class="text"> about a month ago. It is inspired by </span><a id="wallapatta_30025" class="link" href="http://backbonejs.org/">Backbone.js</a><span id="wallapatta_30026" class="text">. Sweet.js supports HTML5 states, so that you don't have to go through work arounds like </span><a id="wallapatta_30027" class="link" href="https://news.ycombinator.com/item?id=6872330">these</a><span id="wallapatta_30028" class="text">. Sweet.js is not a MVC framework, but it has a views similar to Backbone.js, which supports inheritance without affecting events and initializations of super classes. And it's written in Coffeescript.</span></p></div></div><div id="wallapatta_30006" class="section"><h2 class="heading"><span id="wallapatta_30007" class="block"><span id="wallapatta_30031" class="text">Router</span></span></h2><div class="content"><pre id="wallapatta_30008" class="codeBlock"><code class="coffeescript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Router</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Sweet</span>.<span class="hljs-title">Router</span></span>
 <span class="hljs-property">@routes</span> <span class="hljs-comment">#You can add more routes from sub classes</span>
  <span class="hljs-string">''</span>: <span class="hljs-string">'home'</span>
  <span class="hljs-string">'search/:what'</span>: <span class="hljs-string">'results'</span>

 <span class="hljs-attribute">home</span>: <span class="hljs-function">-&gt;</span>
  View.home()

 <span class="hljs-attribute">results</span>: <span class="hljs-function"><span class="hljs-params">(what)</span> -&gt;</span>
  <span class="hljs-built_in">console</span>.log <span class="hljs-property">@getState</span>() <span class="hljs-comment">#state</span>
  View.results(what)

router = <span class="hljs-keyword">new</span> Router()
router.start <span class="hljs-attribute">pushState</span>: <span class="hljs-literal">true</span>

<span class="hljs-comment">#Emulate browser back button</span>
router.back()

<span class="hljs-comment">#Whether we can go back without leaving the web app</span>
router.canBack()</code></pre></div></div><div id="wallapatta_30009" class="section"><h2 class="heading"><span id="wallapatta_30010" class="block"><span id="wallapatta_30032" class="text">Views</span></span></h2><div class="content"><div id="wallapatta_30011" class="section"><div class="content"><p id="wallapatta_30012" class="paragraph"><span id="wallapatta_30033" class="text">A generic form class.</span></p></div></div><pre id="wallapatta_30013" class="codeBlock"><code class="coffeescript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Form</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Sweet</span>.<span class="hljs-title">View</span></span>
 <span class="hljs-property">@events</span>
  <span class="hljs-string">'click .cancel'</span>: <span class="hljs-string">'cancel'</span>
  <span class="hljs-string">'click .submit'</span>: <span class="hljs-string">'submit'</span>

 <span class="hljs-property">@initialize</span> (options) -&gt;
  <span class="hljs-property">@model</span> = options.model

<span class="hljs-attribute">cancel</span>: <span class="hljs-function"><span class="hljs-params">(e)</span> -&gt;</span>
 router.back()</code></pre><div id="wallapatta_30014" class="section"><div class="content"><p id="wallapatta_30015" class="paragraph"><span id="wallapatta_30034" class="text">A registration form class.</span></p></div></div><pre id="wallapatta_30016" class="codeBlock"><code class="coffeescript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RegistrationForm</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Sweet</span>.<span class="hljs-title">View</span></span>
 <span class="hljs-comment">#Register new events without affecting events registered in Form class</span>
 <span class="hljs-property">@events</span>
  <span class="hljs-string">'click .checkUsername'</span>: checkUsername

 <span class="hljs-comment">#Both initialization functions (Form, RegistrationForm) will be called.</span>
 <span class="hljs-property">@initialize</span> (options) -&gt;
  <span class="hljs-property">@userType</span> = options.userType

 <span class="hljs-attribute">submit</span>: <span class="hljs-function"><span class="hljs-params">(e)</span> -&gt;</span>
  <span class="hljs-comment">#Submit form</span>

 <span class="hljs-attribute">checkUsername</span>: <span class="hljs-function"><span class="hljs-params">(e)</span> -&gt;</span>
  <span class="hljs-comment">#Check availability</span></code></pre></div></div><div id="wallapatta_30017" class="section"><div class="content"><p id="wallapatta_30018" class="paragraph"><span id="wallapatta_30035" class="text">This is a very basic library and it will not suit you if you are looking for a MVC. I'm using this in some of my projects, so I will be maintaining it.</span></p></div></div><div id="wallapatta_30019" class="section"><div class="content"><p id="wallapatta_30020" class="paragraph"><span id="wallapatta_30036" class="text">I'm planning to remove the dependency on jQuery and use vanilla javascript.</span></p></div></div></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      <div id="wallapatta_30003" class="sidenote"><div id="wallapatta_30004" class="section"><div class="content"><p id="wallapatta_30005" class="paragraph"><strong id="wallapatta_30029" class="bold"><a id="wallapatta_30030" class="link" href="https://news.ycombinator.com/item?id=6920522">Discuss on Hacker News</a></strong></p></div></div></div>
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>///Another JS Framework
///2013-12-17

I started working on **&lt;&lt;https://github.com/vpj/sweet(Sweet.js)&gt;&gt;** about a month ago. It is inspired by &lt;&lt;http://backbonejs.org/(Backbone.js)&gt;&gt;. Sweet.js supports HTML5 states, so that you don't have to go through work arounds like &lt;&lt;https://news.ycombinator.com/item?id=6872330(these)&gt;&gt;. Sweet.js is not a MVC framework, but it has a views similar to Backbone.js, which supports inheritance without affecting events and initializations of super classes. And it's written in Coffeescript.

&gt;&gt;&gt;
 **&lt;&lt;https://news.ycombinator.com/item?id=6920522(Discuss on Hacker News)&gt;&gt;

## Router

 ```coffeescript
  class Router extends Sweet.Router
   @routes #You can add more routes from sub classes
    '': 'home'
    'search/:what': 'results'

   home: -&gt;
    View.home()

   results: (what) -&gt;
    console.log @getState() #state
    View.results(what)

  router = new Router()
  router.start pushState: true

  #Emulate browser back button
  router.back()

  #Whether we can go back without leaving the web app
  router.canBack()


## Views

 A generic form class.

 ```coffeescript
  class Form extends Sweet.View
   @events
    'click .cancel': 'cancel'
    'click .submit': 'submit'

   @initialize (options) -&gt;
    @model = options.model

  cancel: (e) -&gt;
   router.back()

 A registration form class.

 ```coffeescript
  class RegistrationForm extends Sweet.View
   #Register new events without affecting events registered in Form class
   @events
    'click .checkUsername': checkUsername

   #Both initialization functions (Form, RegistrationForm) will be called.
   @initialize (options) -&gt;
    @userType = options.userType

   submit: (e) -&gt;
    #Submit form

   checkUsername: (e) -&gt;
    #Check availability

This is a very basic library and it will not suit you if you are looking for a MVC. I'm using this in some of my projects, so I will be maintaining it.

I'm planning to remove the dependency on jQuery and use vanilla javascript.</div>
     </div>
     <div class="overlay ">
      
     </div>
    </div>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="app_engine.html">
      Moving from Google Appengine to NodeJS on Amazon EC2
     </a>
    </h1>
    <h3 class="date ">
     December 12, 2013
    </h3>
    <div class="post-paginated ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_40000" class="article"><div id="wallapatta_40001" class="section"><div class="content"><p id="wallapatta_40002" class="paragraph"><a id="wallapatta_40081" class="link" href="http://nearby.lk">nearby.lk</a><span id="wallapatta_40082" class="text"> moved the servers from Google App engine to Amazon EC2 a couple of months back, and the backend is now built with nodejs with mongodb as the database.</span></p></div></div><div id="wallapatta_40006" class="section"><div class="content"><p id="wallapatta_40007" class="paragraph"><span id="wallapatta_40085" class="text">Backend does a lot of pre-computations and caching which gives slower start up times and faster response times. The migration decision was based on a number of factors such as ease of development, performance and cost. There were a bunch of disadvantages of using the app engine, a several benefits of using NodeJS and some things we miss after the migration.</span></p></div></div><div id="wallapatta_40008" class="section"><h2 class="heading"><span id="wallapatta_40009" class="block"><span id="wallapatta_40086" class="text">App Engine: the bad</span></span></h2><div class="content"><div id="wallapatta_40010" class="section"><h3 class="heading"><span id="wallapatta_40011" class="block"><span id="wallapatta_40087" class="text">Data store operations are slow</span></span></h3><div class="content"><div id="wallapatta_40012" class="section"><div class="content"><p id="wallapatta_40013" class="paragraph"><span id="wallapatta_40088" class="text">There were not many data store writes. Almost none on most days since data was uploaded in bulk. Still, the data store reads were significantly slow. To improve performance we kept most of the data in memory, which worked great until the web traffic and database size started growing.</span></p></div></div></div></div><div id="wallapatta_40014" class="section"><h3 class="heading"><span id="wallapatta_40015" class="block"><span id="wallapatta_40089" class="text">Too many instances</span></span></h3><div class="content"><div id="wallapatta_40016" class="section"><div class="content"><p id="wallapatta_40017" class="paragraph"><span id="wallapatta_40090" class="text">App engine does load balancing for you. So when it feels like a single server cannot handle the load it creates multiple instances and balances the load. Although this sounds awesome, it wasn't for us. Pre-computations at start up kept the new instances busy, and app engine was creating more and more instances to handle this. Worst part is that multiple instances weren't actually required to handle the load, but App engine had a few instances running all the time, and we had to pay.</span></p></div></div><div id="wallapatta_40018" class="section"><div class="content"><p id="wallapatta_40019" class="paragraph"><span id="wallapatta_40091" class="text">We tried warm-up requests to keep an extra instance running, to solve the slow start up issue, but it was not of much use.</span></p></div></div></div></div><div id="wallapatta_40020" class="section"><h3 class="heading"><span id="wallapatta_40021" class="block"><span id="wallapatta_40092" class="text">Request Timeouts</span></span></h3><div class="content"><div id="wallapatta_40022" class="section"><div class="content"><p id="wallapatta_40023" class="paragraph"><span id="wallapatta_40093" class="text">Start up pre-computations took more than the request time limit. This made us break down the start up process into smaller chunks and run each part on different requests. That is, an instance would only be ready after a couple of requests were sent to it. Breaking the start up process was a horrible coding experience, and the worst part is that the start up is taking most of it's time reading the data store - the system would start up in within a second on my computer with app engine development server.</span></p></div></div></div></div><div id="wallapatta_40024" class="section"><h3 class="heading"><span id="wallapatta_40025" class="block"><span id="wallapatta_40094" class="text">Memcache</span></span></h3><div class="content"><div id="wallapatta_40026" class="section"><div class="content"><p id="wallapatta_40027" class="paragraph"><span id="wallapatta_40095" class="text">Memcache helped solve the start up issue a bit, but it had a stupid 1MB size limit per entry which made things really hard for the developers. Large objects had to be broken down into pieces smaller than 1MB and if one of them was removed from memcache, everything had to be recomputed. (Search index was larger than 1MB)</span></p></div></div></div></div><div id="wallapatta_40028" class="section"><h3 class="heading"><span id="wallapatta_40029" class="block"><span id="wallapatta_40096" class="text">Uploading and downloading data</span></span></h3><div class="content"><div id="wallapatta_40030" class="section"><div class="content"><p id="wallapatta_40031" class="paragraph"><span id="wallapatta_40097" class="text">This was literally a nightmare. bulk data uploads and downloads had to be broken down into tiny chunks because of the request time limits, and there was no way to access the datastore without writing code to do it.</span></p></div></div></div></div><div id="wallapatta_40032" class="section"><h3 class="heading"><span id="wallapatta_40033" class="block"><span id="wallapatta_40098" class="text">Search API</span></span></h3><div class="content"><div id="wallapatta_40034" class="section"><div class="content"><p id="wallapatta_40035" class="paragraph"><span id="wallapatta_40099" class="text">We HAD to use the search API for the last few months because we couldn't keep our indexes in memory, because of the start up time (discussed earlier). You might expect the search API to be super awesome because it's Google, but it was so slow. May be we didn't use the proper design, but it was the best we could find with the documentation available.</span></p></div></div></div></div></div></div><div id="wallapatta_40036" class="section"><h2 class="heading"><span id="wallapatta_40037" class="block"><span id="wallapatta_40100" class="text">NodeJS: the good</span></span></h2><div class="content"><div id="wallapatta_40038" class="section"><h3 class="heading"><span id="wallapatta_40039" class="block"><span id="wallapatta_40101" class="text">One language</span></span></h3><div class="content"><div id="wallapatta_40040" class="section"><div class="content"><p id="wallapatta_40041" class="paragraph"><span id="wallapatta_40102" class="text">Now the server and user interface are both in javascript, which makes it a lot easier for the developers to switch between the two.</span></p></div></div></div></div><div id="wallapatta_40042" class="section"><h3 class="heading"><span id="wallapatta_40043" class="block"><span id="wallapatta_40103" class="text">Server-side rendering</span></span></h3><div class="content"><div id="wallapatta_40044" class="section"><div class="content"><p id="wallapatta_40045" class="paragraph"><span id="wallapatta_40104" class="text">We don't have to maintain different code to do server side rendering since we can use the same templates on both the server and client.</span></p></div></div></div></div><div id="wallapatta_40046" class="section"><h3 class="heading"><span id="wallapatta_40047" class="block"><span id="wallapatta_40105" class="text">Portable</span></span></h3><div class="content"><div id="wallapatta_40048" class="section"><div class="content"><p id="wallapatta_40049" class="paragraph"><span id="wallapatta_40106" class="text">We can now host our servers anywhere. We are not stuck with any platform, as we were with the app engine - where we had no choice to pay more if they were to change pricing. We are currently hosted on amazon and it is running smoothly. We might switch to a larger server on amazon soon.</span></p></div></div></div></div><div id="wallapatta_40050" class="section"><h3 class="heading"><span id="wallapatta_40051" class="block"><span id="wallapatta_40107" class="text">Speed</span></span></h3><div class="content"><div id="wallapatta_40052" class="section"><div class="content"><p id="wallapatta_40053" class="paragraph"><span id="wallapatta_40108" class="text">The start up time is much faster and requests are handled within a couple of milliseconds. We are using Nginx for all static content.</span></p></div></div></div></div></div></div><div id="wallapatta_40054" class="section"><h2 class="heading"><span id="wallapatta_40055" class="block"><span id="wallapatta_40109" class="text">What we miss</span></span></h2><div class="content"><div id="wallapatta_40056" class="section"><h3 class="heading"><span id="wallapatta_40057" class="block"><span id="wallapatta_40110" class="text">Management Console</span></span></h3><div class="content"><div id="wallapatta_40058" class="section"><div class="content"><p id="wallapatta_40059" class="paragraph"><span id="wallapatta_40111" class="text">Appengine had a nice management console where we could look at logs, system status etc. Now we have to do it through ssh with unix commands. Although this is not a big issue for the developers, now we can't ask someone else to check or restart the servers if needed.</span></p></div></div></div></div><div id="wallapatta_40060" class="section"><h3 class="heading"><span id="wallapatta_40061" class="block"><span id="wallapatta_40112" class="text">Ease of deployment</span></span></h3><div class="content"><div id="wallapatta_40062" class="section"><div class="content"><p id="wallapatta_40063" class="paragraph"><span id="wallapatta_40113" class="text">With app engine, all you have to do deploy is just to run a command. We need to write a small script to do this now.</span></p></div></div></div></div><div id="wallapatta_40064" class="section"><h3 class="heading"><span id="wallapatta_40065" class="block"><span id="wallapatta_40114" class="text">Trying out new stuff</span></span></h3><div class="content"><div id="wallapatta_40066" class="section"><div class="content"><p id="wallapatta_40067" class="paragraph"><span id="wallapatta_40115" class="text">With appengine you can easily create a new account or a new version without interfering with the main system, and do beta testing or A/B testing.</span></p></div></div></div></div></div></div><div id="wallapatta_40068" class="section"><div class="content"><p id="wallapatta_40069" class="paragraph"><span id="wallapatta_40116" class="text">So far we are so glad that we moved away from appengine and we regret that we didn't do it sooner. Development got so much easier and now we are working on stuff that actually adds value to users than hacking the system to deal with all the constraints such as memcache limits, slow datastore reads, etc.</span></p></div></div><div id="wallapatta_40070" class="section"><div class="content"><p id="wallapatta_40071" class="paragraph"><span id="wallapatta_40117" class="text">I wish I read one of these an year ago.</span></p></div></div><ul id="wallapatta_40072" class="list"><li id="wallapatta_40073" class="list-item"><span id="wallapatta_40074" class="block"><a id="wallapatta_40118" class="link" href="http://www.carlosble.com/2010/11/goodbye-google-app-engine-gae/">Good Bye Google App Engine</a></span></li><li id="wallapatta_40075" class="list-item"><span id="wallapatta_40076" class="block"><a id="wallapatta_40119" class="link" href="http://www-cs-students.stanford.edu/~silver/gae.html">The Unofficial Guide to Migrating Off of Google App Engine</a></span></li><li id="wallapatta_40077" class="list-item"><span id="wallapatta_40078" class="block"><a id="wallapatta_40120" class="link" href="http://reliablesoftwares.com/blog/2012/02/12/moving-away-from-google-app-engine/">Moving away from Google App Engine</a></span></li><li id="wallapatta_40079" class="list-item"><span id="wallapatta_40080" class="block"><a id="wallapatta_40121" class="link" href="http://www.war-worlds.com/blog/2013/06/switched-away-from-app-engine-couldnt-be-happier">Switched away from App Engine, couldn't be happier</a></span></li></ul></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      <div id="wallapatta_40003" class="sidenote"><div id="wallapatta_40004" class="section"><div class="content"><p id="wallapatta_40005" class="paragraph"><strong id="wallapatta_40083" class="bold"><a id="wallapatta_40084" class="link" href="https://news.ycombinator.com/item?id=6893495">Hacker News Discussion</a></strong></p></div></div></div>
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>///Moving from Google Appengine to NodeJS on Amazon EC2
///2013-12-12

&lt;&lt;http://nearby.lk(nearby.lk)&gt;&gt; moved the servers from Google App engine to Amazon EC2 a couple of months back, and the backend is now built with nodejs with mongodb as the database.

&gt;&gt;&gt;
 **&lt;&lt;https://news.ycombinator.com/item?id=6893495(Hacker News Discussion)&gt;&gt;

Backend does a lot of pre-computations and caching which gives slower start up times and faster response times. The migration decision was based on a number of factors such as ease of development, performance and cost. There were a bunch of disadvantages of using the app engine, a several benefits of using NodeJS and some things we miss after the migration.

## App Engine: the bad

 ### Data store operations are slow
  There were not many data store writes. Almost none on most days since data was uploaded in bulk. Still, the data store reads were significantly slow. To improve performance we kept most of the data in memory, which worked great until the web traffic and database size started growing.

 ### Too many instances
  App engine does load balancing for you. So when it feels like a single server cannot handle the load it creates multiple instances and balances the load. Although this sounds awesome, it wasn't for us. Pre-computations at start up kept the new instances busy, and app engine was creating more and more instances to handle this. Worst part is that multiple instances weren't actually required to handle the load, but App engine had a few instances running all the time, and we had to pay.

  We tried warm-up requests to keep an extra instance running, to solve the slow start up issue, but it was not of much use.

 ### Request Timeouts
  Start up pre-computations took more than the request time limit. This made us break down the start up process into smaller chunks and run each part on different requests. That is, an instance would only be ready after a couple of requests were sent to it. Breaking the start up process was a horrible coding experience, and the worst part is that the start up is taking most of it's time reading the data store - the system would start up in within a second on my computer with app engine development server.

 ### Memcache
  Memcache helped solve the start up issue a bit, but it had a stupid 1MB size limit per entry which made things really hard for the developers. Large objects had to be broken down into pieces smaller than 1MB and if one of them was removed from memcache, everything had to be recomputed. (Search index was larger than 1MB)

 ### Uploading and downloading data
  This was literally a nightmare. bulk data uploads and downloads had to be broken down into tiny chunks because of the request time limits, and there was no way to access the datastore without writing code to do it.

 ### Search API
  We HAD to use the search API for the last few months because we couldn't keep our indexes in memory, because of the start up time (discussed earlier). You might expect the search API to be super awesome because it's Google, but it was so slow. May be we didn't use the proper design, but it was the best we could find with the documentation available.

## NodeJS: the good

 ### One language
  Now the server and user interface are both in javascript, which makes it a lot easier for the developers to switch between the two.

 ### Server-side rendering
  We don't have to maintain different code to do server side rendering since we can use the same templates on both the server and client.

 ### Portable
  We can now host our servers anywhere. We are not stuck with any platform, as we were with the app engine - where we had no choice to pay more if they were to change pricing. We are currently hosted on amazon and it is running smoothly. We might switch to a larger server on amazon soon.

 ### Speed
  The start up time is much faster and requests are handled within a couple of milliseconds. We are using Nginx for all static content.

## What we miss

 ### Management Console
  Appengine had a nice management console where we could look at logs, system status etc. Now we have to do it through ssh with unix commands. Although this is not a big issue for the developers, now we can't ask someone else to check or restart the servers if needed.

 ### Ease of deployment
  With app engine, all you have to do deploy is just to run a command. We need to write a small script to do this now.

 ### Trying out new stuff
  With appengine you can easily create a new account or a new version without interfering with the main system, and do beta testing or A/B testing.

So far we are so glad that we moved away from appengine and we regret that we didn't do it sooner. Development got so much easier and now we are working on stuff that actually adds value to users than hacking the system to deal with all the constraints such as memcache limits, slow datastore reads, etc.

I wish I read one of these an year ago.

* &lt;&lt;http://www.carlosble.com/2010/11/goodbye-google-app-engine-gae/(Good Bye Google App Engine)&gt;&gt;
* &lt;&lt;http://www-cs-students.stanford.edu/~silver/gae.html(The Unofficial Guide to Migrating Off of Google App Engine&gt;&gt;
* &lt;&lt;http://reliablesoftwares.com/blog/2012/02/12/moving-away-from-google-app-engine/(Moving away from Google App Engine)&gt;&gt;
* &lt;&lt;http://www.war-worlds.com/blog/2013/06/switched-away-from-app-engine-couldnt-be-happier(Switched away from App Engine, couldn't be happier)&gt;&gt;
</div>
     </div>
     <div class="overlay ">
      
     </div>
    </div>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="coffeescript_macros.html">
      Coffeescript Macros
     </a>
    </h1>
    <h3 class="date ">
     December 9, 2013
    </h3>
    <div class="post-paginated ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_50000" class="article"><div id="wallapatta_50001" class="section"><div class="content"><p id="wallapatta_50002" class="paragraph"><span id="wallapatta_50027" class="text">Anyone who programs in C uses pre-processor macros to keep the code clean, maintainable and sometimes to improve run-time performance. You can use the same C pre-processor to include macros in [Coffeescript](http://coffeescript.org/) or Javascript code, and it is easy!</span></p></div></div><div id="wallapatta_50003" class="section"><div class="content"><p id="wallapatta_50004" class="paragraph"><span id="wallapatta_50028" class="text">The coffeescript file needs to be renamed with `.c` extension before running it thrrough `gcc`; otherwise, it gives a warning and doesn't run the pre-processor. There may be some option to force it compile without checking the extension.</span></p></div></div><pre id="wallapatta_50005" class="codeBlock"><code class="bash">cp [source.coffe] [source.c]
gcc -E [source.c] &gt; [processed.coffee]</code></pre><div id="wallapatta_50006" class="section"><h2 class="heading"><span id="wallapatta_50007" class="block"><span id="wallapatta_50029" class="text">Examples</span></span></h2><div class="content"><div id="wallapatta_50008" class="section"><h3 class="heading"><span id="wallapatta_50009" class="block"><span id="wallapatta_50030" class="text">Improve performance</span></span></h3><div class="content"><div id="wallapatta_50010" class="section"><div class="content"><p id="wallapatta_50011" class="paragraph"><span id="wallapatta_50031" class="text">This is the code with macros. It compares the time taken to calculate the sum of squares, using `function`s and macros.</span></p></div></div><pre id="wallapatta_50012" class="codeBlock"><code class="coffeescript"><span class="hljs-function"><span class="hljs-title">square</span> = <span class="hljs-params">(x)</span> -&gt;</span> x * x

<span class="hljs-comment">#define SQUARE(x) (x * x)</span>

total = <span class="hljs-number">0</span>
<span class="hljs-built_in">console</span>.time <span class="hljs-string">"no macro"</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span>.<span class="hljs-number">.100000</span>]
 total += square i
<span class="hljs-built_in">console</span>.timeEnd <span class="hljs-string">"no macro"</span>
<span class="hljs-built_in">console</span>.log <span class="hljs-string">"Total <span class="hljs-subst">#{total}</span>"</span>

total = <span class="hljs-number">0</span>

<span class="hljs-built_in">console</span>.time <span class="hljs-string">"macro"</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span>.<span class="hljs-number">.100000</span>]
 total += SQUARE(i)

<span class="hljs-built_in">console</span>.timeEnd <span class="hljs-string">"macro"</span>
<span class="hljs-built_in">console</span>.log <span class="hljs-string">"Total <span class="hljs-subst">#{total}</span>"</span></code></pre><div id="wallapatta_50013" class="section"><div class="content"><p id="wallapatta_50014" class="paragraph"><span id="wallapatta_50032" class="text">Compiled code:</span></p></div></div><pre id="wallapatta_50015" class="codeBlock"><code class="javascript"># <span class="hljs-number">1</span> <span class="hljs-string">"macro.c"</span>
# <span class="hljs-number">1</span> <span class="hljs-string">"&lt;built-in&gt;"</span>
# <span class="hljs-number">1</span> <span class="hljs-string">"&lt;command-line&gt;"</span>
# <span class="hljs-number">1</span> <span class="hljs-string">"macro.c"</span>

square = (x) -&gt; x * x

total = <span class="hljs-number">0</span>
<span class="hljs-built_in">console</span>.time <span class="hljs-string">"no macro"</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span>.<span class="hljs-number">.100000</span>]
 total += square i
<span class="hljs-built_in">console</span>.timeEnd <span class="hljs-string">"no macro"</span>
<span class="hljs-built_in">console</span>.log <span class="hljs-string">"Total #{total}"</span>

total = <span class="hljs-number">0</span>

<span class="hljs-built_in">console</span>.time <span class="hljs-string">"macro"</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span>.<span class="hljs-number">.100000</span>]
 total += (i * i)

<span class="hljs-built_in">console</span>.timeEnd <span class="hljs-string">"macro"</span>
<span class="hljs-built_in">console</span>.log <span class="hljs-string">"Total #{total}"</span></code></pre><div id="wallapatta_50016" class="section"><div class="content"><p id="wallapatta_50017" class="paragraph"><span id="wallapatta_50033" class="text">Output:</span></p></div></div><pre id="wallapatta_50018" class="codeBlock"><code class="nohighlight">no macro: 2ms
Total 333328333350000
macro: 1ms
Total 333328333350000</code></pre></div></div><div id="wallapatta_50019" class="section"><h3 class="heading"><span id="wallapatta_50020" class="block"><span id="wallapatta_50034" class="text">Debugging</span></span></h3><div class="content"><div id="wallapatta_50021" class="section"><div class="content"><p id="wallapatta_50022" class="paragraph"><span id="wallapatta_50035" class="text">You can use you favorite DEBUG macro to define LOGS, and even `</span><sub id="wallapatta_50036" class="subScript"><span id="wallapatta_50037" class="text">LINE</span></sub><span id="wallapatta_50038" class="text">` and `</span><sub id="wallapatta_50039" class="subScript"><span id="wallapatta_50040" class="text">FILE</span></sub><span id="wallapatta_50041" class="text">`</span></p></div></div><pre id="wallapatta_50023" class="codeBlock"><code class="coffeescript"><span class="hljs-comment">#define DEBUG</span>

<span class="hljs-comment">#ifdef DEBUG</span>
<span class="hljs-comment">#define LOG(x) console.log __LINE__ + ": " + (x)</span>
<span class="hljs-comment">#else</span>
<span class="hljs-comment">#define LOG(x)</span>
<span class="hljs-comment">#endif</span>

n = <span class="hljs-number">3</span>
LOG(<span class="hljs-string">"Root of <span class="hljs-subst">#{n}</span> = <span class="hljs-subst">#{Math.sqrt(n)}</span>"</span>)</code></pre><div id="wallapatta_50024" class="section"><div class="content"><p id="wallapatta_50025" class="paragraph"><span id="wallapatta_50042" class="text">There is a slight problem because `#` is used for comments in Coffeescript. All you need to do is to use `##` instead of a single `#` when you want to add a comment.</span></p></div></div><pre id="wallapatta_50026" class="codeBlock"><code class="coffeescript"><span class="hljs-comment">#define DEBUG</span>

<span class="hljs-comment">##This is a comment</span>

<span class="hljs-comment">#ifdef DEBUG</span>
<span class="hljs-comment">## Define LOG macro</span>
<span class="hljs-comment">## Print line number</span>
<span class="hljs-comment">#define LOG(x) console.log __LINE__ + ": " + (x)</span>
<span class="hljs-comment">#else</span>
<span class="hljs-comment">#define LOG(x)</span>
<span class="hljs-comment">#endif</span>

n = <span class="hljs-number">3</span>
LOG(<span class="hljs-string">"Root of <span class="hljs-subst">#{n}</span> = <span class="hljs-subst">#{Math.sqrt(n)}</span>"</span>)</code></pre></div></div></div></div></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>///Coffeescript and C Macros: Clean and Fast

Anyone who programs in C uses pre-processor macros to keep the code clean, maintainable and sometimes to improve run-time performance. You can use the same C pre-processor to include macros in [Coffeescript](http://coffeescript.org/) or Javascript code, and it is easy!

The coffeescript file needs to be renamed with `.c` extension before running it thrrough `gcc`; otherwise, it gives a warning and doesn't run the pre-processor. There may be some option to force it compile without checking the extension.

```bash
 cp [source.coffe] [source.c]
 gcc -E [source.c] &gt; [processed.coffee]

## Examples

 ### Improve performance

  This is the code with macros. It compares the time taken to calculate the sum of squares, using `function`s and macros.

  ```coffeescript
   square = (x) -&gt; x * x

   #define SQUARE(x) (x * x)

   total = 0
   console.time "no macro"
   for i in [0...100000]
    total += square i
   console.timeEnd "no macro"
   console.log "Total #{total}"

   total = 0

   console.time "macro"
   for i in [0...100000]
    total += SQUARE(i)

   console.timeEnd "macro"
   console.log "Total #{total}"

  Compiled code:

  ```javascript
   # 1 "macro.c"
   # 1 "&lt;built-in&gt;"
   # 1 "&lt;command-line&gt;"
   # 1 "macro.c"

   square = (x) -&gt; x * x

   total = 0
   console.time "no macro"
   for i in [0...100000]
    total += square i
   console.timeEnd "no macro"
   console.log "Total #{total}"

   total = 0

   console.time "macro"
   for i in [0...100000]
    total += (i * i)

   console.timeEnd "macro"
   console.log "Total #{total}"

  Output:

  ```
   no macro: 2ms
   Total 333328333350000
   macro: 1ms
   Total 333328333350000

 ### Debugging

  You can use you favorite DEBUG macro to define LOGS, and even `__LINE__` and `__FILE__`

  ```coffeescript
   #define DEBUG

   #ifdef DEBUG
   #define LOG(x) console.log __LINE__ + ": " + (x)
   #else
   #define LOG(x)
   #endif

   n = 3
   LOG("Root of #{n} = #{Math.sqrt(n)}")

  There is a slight problem because `#` is used for comments in Coffeescript. All you need to do is to use `##` instead of a single `#` when you want to add a comment.

  ```coffeescript
   #define DEBUG

   ##This is a comment

   #ifdef DEBUG
   ## Define LOG macro
   ## Print line number
   #define LOG(x) console.log __LINE__ + ": " + (x)
   #else
   #define LOG(x)
   #endif

   n = 3
   LOG("Root of #{n} = #{Math.sqrt(n)}")
</div>
     </div>
     <div class="overlay ">
      
     </div>
    </div>
   </div>
   <div class="paginate ">
    <a class="prev-page button " href="page2.html">
     prev
    </a>
    <a class="next-page button " href="page4.html">
     next
    </a>
   </div>
  </div>
  <script src="lib/highlightjs/highlight.pack.js">
  </script>
  <script src="lib/weya/weya.js">
  </script>
  <script src="lib/weya/base.js">
  </script>
  <script src="lib/mod/mod.js">
  </script>
  <script src="js/static.js?v=9">
  </script>
  <script src="js/parser.js?v=9">
  </script>
  <script src="js/reader.js?v=9">
  </script>
  <script src="js/nodes.js?v=9">
  </script>
  <script src="js/render.js?v=9">
  </script>
 </body>
</html>
