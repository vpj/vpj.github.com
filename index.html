<!DOCTYPE html><html>
 <head>
  <meta charset="utf-8">
  </meta>
  <title>
   Varuna Jayasiri
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </meta>
  <meta name="apple-mobile-web-app-capable" content="yes">
  </meta>
  <link href="http://fonts.googleapis.com/css?family=Raleway:400,100,200,300,500,600,700,800,900" rel="stylesheet" type="text/css">
  </link>
  <link href="lib/skeleton/css/skeleton.css" rel="stylesheet">
  </link>
  <link href="lib/highlightjs/styles/default.css" rel="stylesheet">
  </link>
  <link href="css/style.css" rel="stylesheet">
  </link>
  <link href="css/paginate.css" rel="stylesheet">
  </link>
  <link href="blog.css" rel="stylesheet">
  </link>
  <script>
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-44255805-1', 'auto');
ga('send', 'pageview');
  </script>
 </head>
 <body>
  <div class="container wallapatta-container ">
   <div class="header ">
    <h1>
     <a href="index.html">
      VARUNA JAYASIRI
     </a>
    </h1>
    <a class="button " href="https://www.twitter.com/vpj">
     @vpj
    </a>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="node_performance_tips.html">
      node.js/Javascript performance tips
     </a>
    </h1>
    <h3 class="date ">
     March 19, 2016
    </h3>
    <div class="row ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_0" class="article"><div id="wallapatta_1" class="section"><div class="content"><p id="wallapatta_2" class="paragraph"><span id="wallapatta_44" class="text">Here's a list of small node.js related performance tips. I will keep updating this with new stuff we come across.</span></p></div></div><div id="wallapatta_3" class="section"><h2 class="heading"><span id="wallapatta_4" class="block"><code id="wallapatta_45" class="code"><span id="wallapatta_46" class="text">vm.runInContext</span></code><span id="wallapatta_47" class="text"> vs </span><code id="wallapatta_48" class="code"><span id="wallapatta_49" class="text">vm.runInThisContext</span></code></span></h2><div class="content"><div id="wallapatta_8" class="section"><div class="content"><p id="wallapatta_9" class="paragraph"><code id="wallapatta_51" class="code"><span id="wallapatta_52" class="text">runInContext</span></code><span id="wallapatta_53" class="text"> and </span><code id="wallapatta_54" class="code"><span id="wallapatta_55" class="text">runInNewContext</span></code><span id="wallapatta_56" class="text"> are much slower than </span><code id="wallapatta_57" class="code"><span id="wallapatta_58" class="text">runInThisContext</span></code><span id="wallapatta_59" class="text">.</span></p></div></div><div id="wallapatta_10" class="section"><div class="content"><p id="wallapatta_11" class="paragraph"><span id="wallapatta_60" class="text">Here's a small script that compares the performance with a simple for loop.</span></p></div></div><pre id="wallapatta_12" class="codeBlock"><code class="coffee">vm = <span class="hljs-built_in">require</span> <span class="hljs-string">'vm'</span>
LOG = (<span class="hljs-built_in">require</span> <span class="hljs-string">'../lib/log.js/log'</span>).log

N = <span class="hljs-number">10000000</span>
COUNT_SCRIPT = <span class="hljs-string">"for(var i = 0; i &lt; <span class="hljs-subst">#{N}</span>; ++i) { count++; }"</span>

T = (<span class="hljs-keyword">new</span> Date).getTime()
count = <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span>..N]
 count++
LOG <span class="hljs-string">'info'</span>, <span class="hljs-string">'normal_time'</span>, <span class="hljs-string">"<span class="hljs-subst">#{(<span class="hljs-keyword">new</span> Date).getTime() - T}</span>ms"</span>, <span class="hljs-attribute">count</span>: count

<span class="hljs-built_in">global</span>.count = <span class="hljs-number">0</span>
script = <span class="hljs-keyword">new</span> vm.Script COUNT_SCRIPT
T = (<span class="hljs-keyword">new</span> Date).getTime()
<span class="hljs-keyword">try</span>
 script.runInThisContext <span class="hljs-attribute">timeout</span>: <span class="hljs-number">100</span>
<span class="hljs-keyword">catch</span> e
 LOG <span class="hljs-string">'error'</span>, <span class="hljs-string">'vm_error'</span>, e.message
LOG <span class="hljs-string">'info'</span>, <span class="hljs-string">'run_in_this'</span>, <span class="hljs-string">"<span class="hljs-subst">#{(<span class="hljs-keyword">new</span> Date).getTime() - T}</span>ms"</span>, <span class="hljs-attribute">count</span>: <span class="hljs-built_in">global</span>.count

sandbox = <span class="hljs-attribute">count</span>: <span class="hljs-number">0</span>
context = vm.createContext sandbox
script = <span class="hljs-keyword">new</span> vm.Script COUNT_SCRIPT
T = (<span class="hljs-keyword">new</span> Date).getTime()
<span class="hljs-keyword">try</span>
 script.runInContext context, <span class="hljs-attribute">timeout</span>: <span class="hljs-number">1000</span>
<span class="hljs-keyword">catch</span> e
 LOG <span class="hljs-string">'error'</span>, <span class="hljs-string">'vm_error'</span>, e.message
LOG <span class="hljs-string">'info'</span>, <span class="hljs-string">'run_in_context'</span>, <span class="hljs-string">"<span class="hljs-subst">#{(<span class="hljs-keyword">new</span> Date).getTime() - T}</span>ms"</span>, sandbox</code></pre><div id="wallapatta_13" class="section"><div class="content"><p id="wallapatta_14" class="paragraph"><span id="wallapatta_61" class="text">This is the output</span></p></div></div><div id="wallapatta_15" class="image-container"><img class="image" src="img/node-performance/vm.png" alt="img/node-performance/vm.png"></div></div></div><div id="wallapatta_21" class="section"><h2 class="heading"><span id="wallapatta_22" class="block"><span id="wallapatta_72" class="text">Heap Limit</span></span></h2><div class="content"><div id="wallapatta_23" class="section"><div class="content"><p id="wallapatta_24" class="paragraph"><span id="wallapatta_73" class="text">The heap size limit of node.js applications on 64-bit system is about 1.7gb. Fortunately, you can increase this by passing </span><code id="wallapatta_74" class="code"><span id="wallapatta_75" class="text">max_old_space_size</span></code><span id="wallapatta_76" class="text"> parameter to node.</span></p></div></div><pre id="wallapatta_25" class="codeBlock"><code class="bash">node --max_old_space_size=<span class="hljs-number">4096</span> [JS_FILE]</code></pre><div id="wallapatta_29" class="section"><div class="content"><p id="wallapatta_30" class="paragraph"><span id="wallapatta_78" class="text">However, </span><a id="wallapatta_79" class="link" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Typed_arrays">typed arrays</a><span id="wallapatta_80" class="text"> are not bound by this limit. That is, you can allocate a few gigabytes of memory to typed arrays without specifying the above parameter.</span></p></div></div></div></div><div id="wallapatta_31" class="section"><h2 class="heading"><span id="wallapatta_32" class="block"><span id="wallapatta_81" class="text">Parent of sliced string</span></span></h2><div class="content"><div id="wallapatta_36" class="section"><div class="content"><p id="wallapatta_37" class="paragraph"><span id="wallapatta_83" class="text">Substrings of large strings keep a reference to the parent string. This eats up memory if you want to discard the parent string.</span></p></div></div><div id="wallapatta_38" class="section"><div class="content"><p id="wallapatta_39" class="paragraph"><span id="wallapatta_84" class="text">A quick hack of splitting and joining the substring solves this.</span></p></div></div></div></div><div id="wallapatta_40" class="section"><h2 class="heading"><span id="wallapatta_41" class="block"><span id="wallapatta_85" class="text">String join</span></span></h2><div class="content"><div id="wallapatta_42" class="section"><div class="content"><p id="wallapatta_43" class="paragraph"><span id="wallapatta_86" class="text">String concatenation </span><code id="wallapatta_87" class="code"><span id="wallapatta_88" class="text">s += part</span></code><span id="wallapatta_89" class="text"> eats up a lot of memory, that doesn't get garbage collected. It's ok for a few concatenations. Anything more than 10 should use </span><code id="wallapatta_90" class="code"><span id="wallapatta_91" class="text">Array.join</span></code><span id="wallapatta_92" class="text">.</span></p></div></div></div></div></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      <div id="wallapatta_5" class="sidenote"><div id="wallapatta_6" class="section"><div class="content"><p id="wallapatta_7" class="paragraph"><a id="wallapatta_50" class="link" href="https://nodejs.org/api/vm.html">Documentation</a></p></div></div></div><div id="wallapatta_16" class="sidenote"><div id="wallapatta_17" class="section"><div class="content"><p id="wallapatta_18" class="paragraph"><span id="wallapatta_62" class="text">The reason why the </span><strong id="wallapatta_63" class="bold"><span id="wallapatta_64" class="text">normal_time</span></strong><span id="wallapatta_65" class="text"> is higher than </span><strong id="wallapatta_66" class="bold"><span id="wallapatta_67" class="text">run_in_this</span></strong><span id="wallapatta_68" class="text"> is probably because coffeescript for loop has two counters.</span></p></div></div><div id="wallapatta_19" class="section"><div class="content"><p id="wallapatta_20" class="paragraph"><code id="wallapatta_69" class="code"><span id="wallapatta_70" class="text">runInContext</span></code><span id="wallapatta_71" class="text"> gets terminated within the timeout (1s) before it completes the loop.</span></p></div></div></div><div id="wallapatta_26" class="sidenote"><div id="wallapatta_27" class="section"><div class="content"><p id="wallapatta_28" class="paragraph"><span id="wallapatta_77" class="text">The value is specified in megabytes.</span></p></div></div></div><div id="wallapatta_33" class="sidenote"><div id="wallapatta_34" class="section"><div class="content"><p id="wallapatta_35" class="paragraph"><a id="wallapatta_82" class="link" href="http://vpj.github.io/string_slice.html">Wrote a separate post on this</a></p></div></div></div>
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>Here's a list of small node.js related performance tips.
I will keep updating this with new stuff we come across.

##``vm.runInContext`` vs ``vm.runInThisContext``

 &gt;&gt;&gt;
  &lt;&lt;https://nodejs.org/api/vm.html(Documentation)&gt;&gt;

 ``runInContext`` and ``runInNewContext`` are much slower than ``runInThisContext``.

 Here's a small script that compares the performance with a simple for loop.

 ```coffee
  vm = require 'vm'
  LOG = (require '../lib/log.js/log').log

  N = 10000000
  COUNT_SCRIPT = "for(var i = 0; i &lt; #{N}; ++i) { count++; }"

  T = (new Date).getTime()
  count = 0
  for i in [0...N]
   count++
  LOG 'info', 'normal_time', "#{(new Date).getTime() - T}ms", count: count

  global.count = 0
  script = new vm.Script COUNT_SCRIPT
  T = (new Date).getTime()
  try
   script.runInThisContext timeout: 100
  catch e
   LOG 'error', 'vm_error', e.message
  LOG 'info', 'run_in_this', "#{(new Date).getTime() - T}ms", count: global.count

  sandbox = count: 0
  context = vm.createContext sandbox
  script = new vm.Script COUNT_SCRIPT
  T = (new Date).getTime()
  try
   script.runInContext context, timeout: 1000
  catch e
   LOG 'error', 'vm_error', e.message
  LOG 'info', 'run_in_context', "#{(new Date).getTime() - T}ms", sandbox

 This is the output

 !img/node-performance/vm.png

 &gt;&gt;&gt;
  The reason why the **normal_time** is higher than **run_in_this** is
  probably because coffeescript for loop has two counters.

  ``runInContext`` gets terminated within the timeout (1s) before it completes the loop.

##Heap Limit

 The heap size limit of node.js applications on 64-bit system is about 1.7gb.
 Fortunately, you can increase this by passing ``max_old_space_size`` parameter to node.

 ```bash
  node --max_old_space_size=4096 [JS_FILE]

 &gt;&gt;&gt;
  The value is specified in megabytes.

 However, &lt;&lt;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Typed_arrays(typed arrays)&gt;&gt; are not bound by this limit.
 That is, you can allocate a few gigabytes of memory to typed arrays
 without specifying the above parameter.

##Parent of sliced string

 &gt;&gt;&gt;
  &lt;&lt;http://vpj.github.io/string_slice.html(Wrote a separate post on this)&gt;&gt;

 Substrings of large strings keep a reference to the parent string. This eats up memory if you want to discard the parent string.

 A quick hack of splitting and joining the substring solves this.

##String join

 String concatenation ``s += part`` eats up a lot of memory, that doesn't get garbage collected. It's ok for a few concatenations. Anything more than 10 should use ``Array.join``.</div>
     </div>
    </div>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="wallapatta_scripts.html">
      Wallapatta Update
     </a>
    </h1>
    <h3 class="date ">
     December 01, 2015
    </h3>
    <div class="row ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_10000" class="article"><div id="wallapatta_10001" class="section"><div class="content"><p id="wallapatta_10002" class="paragraph"><a id="wallapatta_10037" class="link" href="https://github.com/vpj/wallapatta">Wallapatta</a><sup id="wallapatta_10038" class="superScript"><span id="wallapatta_10039" class="text">1</span></sup><span id="wallapatta_10040" class="text"> got some new features.</span></p></div></div><div id="wallapatta_10013" class="full"><div id="wallapatta_10015" class="section"><div class="content"><p id="wallapatta_10016" class="paragraph"><span id="wallapatta_10047" class="text">First is full width blocks. These span into the sidenote area. These are ideal for large images and quotes.</span></p></div></div><div id="wallapatta_10017" class="image-container"><img class="image" src="https://static.pexels.com/photos/6547/sky-night-space-galaxy-large.jpeg" alt="https://static.pexels.com/photos/6547/sky-night-space-galaxy-large.jpeg"></div></div><div id="wallapatta_10018" class="section"><div class="content"><p id="wallapatta_10019" class="paragraph"><span id="wallapatta_10048" class="text">Next is javascript, coffeescript or weya template blocks. These can have code that generates html.</span></p></div></div><div id="wallapatta_10020" class="section"><div class="content"><p id="wallapatta_10021" class="paragraph"><span id="wallapatta_10049" class="text">Heres a coffeescript block.</span></p><pre id="wallapatta_10022" class="codeBlock"><code class="coffeescript">&lt;&lt;&lt;coffee
 <span class="hljs-string">"7 * 100 = &lt;strong&gt;<span class="hljs-subst">#{<span class="hljs-number">7</span> * <span class="hljs-number">100</span>}</span>&lt;/strong&gt;"</span></code></pre></div></div><div id="wallapatta_10025" class="section"><div class="content"><p id="wallapatta_10026" class="paragraph"><span id="wallapatta_10050" class="text">Here's a weya block that generates the </span><a id="wallapatta_10051" class="link" href="http://www.forestpin.com">Forestpin</a><span id="wallapatta_10052" class="text"> logo in an SVG.</span></p><pre id="wallapatta_10030" class="codeBlock"><code class="coffeescript">&lt;&lt;&lt;weya
 G = <span class="hljs-number">1.618</span>
 H = <span class="hljs-number">13</span>
 order = [<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>]
 heights = (H * Math.pow G, i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> order)
 <span class="hljs-property">@svg</span> <span class="hljs-attribute">width</span>: <span class="hljs-number">250</span>, <span class="hljs-attribute">height</span>: <span class="hljs-number">250</span>, <span class="hljs-function">-&gt;</span>
  <span class="hljs-property">@g</span> <span class="hljs-attribute">transform</span>: <span class="hljs-string">"translate(2, 154)"</span>, <span class="hljs-function">-&gt;</span>
   <span class="hljs-keyword">for</span> h, i <span class="hljs-keyword">in</span> heights
    <span class="hljs-property">@g</span> <span class="hljs-string">".bar"</span>, <span class="hljs-attribute">transform</span>: <span class="hljs-string">"translate(<span class="hljs-subst">#{i * <span class="hljs-number">50</span>}</span>, 0)"</span>, <span class="hljs-function">-&gt;</span>
     <span class="hljs-property">@rect</span> <span class="hljs-attribute">y</span>: -h * G, <span class="hljs-attribute">width</span>: <span class="hljs-number">46</span>, <span class="hljs-attribute">height</span>: h * G, <span class="hljs-attribute">fill</span>: <span class="hljs-string">'#4a4a4a'</span>
     <span class="hljs-property">@rect</span> <span class="hljs-attribute">width</span>: <span class="hljs-number">30.67</span>, <span class="hljs-attribute">height</span>: h,<span class="hljs-attribute">fill</span>: <span class="hljs-string">'#98ff98'</span>
     <span class="hljs-property">@rect</span> <span class="hljs-attribute">x</span>: <span class="hljs-number">30.67</span>, <span class="hljs-attribute">width</span>: <span class="hljs-number">15.33</span>, <span class="hljs-attribute">height</span>: h, <span class="hljs-attribute">fill</span>: <span class="hljs-string">'#8bea8b'</span></code></pre><div id="wallapatta_10034" class="html"><svg width="250" height="250">
 <g transform="translate(2, 154)">
  <g class="bar " transform="translate(0, 0)">
   <rect y="-55.06541341600001" width="46" height="55.06541341600001" fill="#4a4a4a">
   </rect>
   <rect width="30.67" height="34.03301200000001" fill="#98ff98">
   </rect>
   <rect x="30.67" width="15.33" height="34.03301200000001" fill="#8bea8b">
   </rect>
  </g>
  <g class="bar " transform="translate(50, 0)">
   <rect y="-144.15706735166842" width="46" height="144.15706735166842" fill="#4a4a4a">
   </rect>
   <rect width="30.67" height="89.09583890708802" fill="#98ff98">
   </rect>
   <rect x="30.67" width="15.33" height="89.09583890708802" fill="#8bea8b">
   </rect>
  </g>
  <g class="bar " transform="translate(100, 0)">
   <rect y="-34.03301200000001" width="46" height="34.03301200000001" fill="#4a4a4a">
   </rect>
   <rect width="30.67" height="21.034000000000002" fill="#98ff98">
   </rect>
   <rect x="30.67" width="15.33" height="21.034000000000002" fill="#8bea8b">
   </rect>
  </g>
  <g class="bar " transform="translate(150, 0)">
   <rect y="-21.034000000000002" width="46" height="21.034000000000002" fill="#4a4a4a">
   </rect>
   <rect width="30.67" height="13" fill="#98ff98">
   </rect>
   <rect x="30.67" width="15.33" height="13" fill="#8bea8b">
   </rect>
  </g>
  <g class="bar " transform="translate(200, 0)">
   <rect y="-89.09583890708802" width="46" height="89.09583890708802" fill="#4a4a4a">
   </rect>
   <rect width="30.67" height="55.06541341600001" fill="#98ff98">
   </rect>
   <rect x="30.67" width="15.33" height="55.06541341600001" fill="#8bea8b">
   </rect>
  </g>
 </g>
</svg>
</div></div></div><div id="wallapatta_10035" class="section"><div class="content"><p id="wallapatta_10036" class="paragraph"><span id="wallapatta_10057" class="text">Checkout </span><a id="wallapatta_10058" class="link"><span id="wallapatta_10059" class="text"> for details</span></a></p></div></div></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      <div id="wallapatta_10003" class="sidenote"><div id="wallapatta_10004" class="section"><div class="content"><p id="wallapatta_10005" class="paragraph"><sup id="wallapatta_10041" class="superScript"><span id="wallapatta_10042" class="text">1</span></sup><span id="wallapatta_10043" class="text"> Wallapatta is similar to markdown. It supports a document layout inspired by Edward Tufte's handouts and books. This blog is written in Wallapatta.</span></p></div></div><ul id="wallapatta_10006" class="list"><li id="wallapatta_10007" class="list-item"><span id="wallapatta_10008" class="block"><a id="wallapatta_10044" class="link" href="https://chrome.google.com/webstore/detail/wallapatta/nleponjjojkllonfamfjhebhadibjlip">Editor</a></span></li><li id="wallapatta_10009" class="list-item"><span id="wallapatta_10010" class="block"><a id="wallapatta_10045" class="link" href="https://github.com/vpj/wallapatta">Github</a></span></li><li id="wallapatta_10011" class="list-item"><span id="wallapatta_10012" class="block"><a id="wallapatta_10046" class="link" href="http://vpj.github.io/wallapatta/reference.html#wallapatta_335">Reference</a></span></li></ul></div><div id="wallapatta_10014" class="sidenote"></div><div id="wallapatta_10023" class="sidenote"><div id="wallapatta_10024" class="html">7 * 100 = <strong>700</strong></div></div><div id="wallapatta_10027" class="sidenote"><div id="wallapatta_10028" class="section"><div class="content"><p id="wallapatta_10029" class="paragraph"><a id="wallapatta_10053" class="link" href="https://github.com/vpj/weya">Weya on Github</a></p></div></div></div><div id="wallapatta_10031" class="sidenote"><div id="wallapatta_10032" class="section"><div class="content"><p id="wallapatta_10033" class="paragraph"><span id="wallapatta_10054" class="text">It generates the </span><a id="wallapatta_10055" class="link" href="https://www.forestpin.com">Forestpin</a><span id="wallapatta_10056" class="text"> Logo</span></p></div></div></div>
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>&lt;&lt;https://github.com/vpj/wallapatta(Wallapatta)&gt;&gt;^^1^^ got some new features.

&gt;&gt;&gt;
 ^^1^^ Wallapatta is similar to markdown. It supports a document layout inspired by Edward Tufte's handouts and books. This blog is written in Wallapatta.

 * &lt;&lt;https://chrome.google.com/webstore/detail/wallapatta/nleponjjojkllonfamfjhebhadibjlip(Editor)&gt;&gt;
 * &lt;&lt;https://github.com/vpj/wallapatta(Github)&gt;&gt;
 * &lt;&lt;http://vpj.github.io/wallapatta/reference.html#wallapatta_335(Reference)&gt;&gt;

&lt;!&gt;
 First is full width blocks. These span into the sidenote area.
 These are ideal for large images and quotes.

 !https://static.pexels.com/photos/6547/sky-night-space-galaxy-large.jpeg

Next is javascript, coffeescript or weya template blocks.
These can have code that generates html.

Heres a coffeescript block.

 ```coffeescript
  &lt;&lt;&lt;coffee
   "7 * 100 = &lt;strong&gt;#{7 * 100}&lt;/strong&gt;"

 &gt;&gt;&gt;
  &lt;&lt;&lt;coffee
   "7 * 100 = &lt;strong&gt;#{7 * 100}&lt;/strong&gt;"

Here's a weya block that generates the &lt;&lt;http://www.forestpin.com(Forestpin)&gt;&gt; logo in an SVG.

 &gt;&gt;&gt;
  &lt;&lt;https://github.com/vpj/weya(Weya on Github)&gt;&gt;

 ```coffeescript
  &lt;&lt;&lt;weya
   G = 1.618
   H = 13
   order = [2, 4, 1, 0, 3]
   heights = (H * Math.pow G, i for i in order)
   @svg width: 250, height: 250, -&gt;
    @g transform: "translate(2, 154)", -&gt;
     for h, i in heights
      @g ".bar", transform: "translate(#{i * 50}, 0)", -&gt;
       @rect y: -h * G, width: 46, height: h * G, fill: '#4a4a4a'
       @rect width: 30.67, height: h,fill: '#98ff98'
       @rect x: 30.67, width: 15.33, height: h, fill: '#8bea8b'

 &gt;&gt;&gt;
  It generates the &lt;&lt;https://www.forestpin.com(Forestpin)&gt;&gt; Logo

 &lt;&lt;&lt;weya
  G = 1.618
  H = 13
  order = [2, 4, 1, 0, 3]
  heights = (H * Math.pow G, i for i in order)
  @svg width: 250, height: 250, -&gt;
   @g transform: "translate(2, 154)", -&gt;
    for h, i in heights
     @g ".bar", transform: "translate(#{i * 50}, 0)", -&gt;
      @rect y: -h * G, width: 46, height: h * G, fill: '#4a4a4a'
      @rect width: 30.67, height: h,fill: '#98ff98'
      @rect x: 30.67, width: 15.33, height: h, fill: '#8bea8b'


Checkout &lt;&lt; for details
</div>
     </div>
    </div>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="string_slice.html">
      Parent in (sliced string)
     </a>
    </h1>
    <h3 class="date ">
     November 23, 2015
    </h3>
    <div class="row ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_20000" class="article"><div id="wallapatta_20001" class="full"><div id="wallapatta_20003" class="image-container"><img class="image" src="img/sliced_string.png" alt="img/sliced_string.png"></div></div><div id="wallapatta_20004" class="section"><div class="content"><p id="wallapatta_20005" class="paragraph"><span id="wallapatta_20034" class="text">In Google Chrome </span><sup id="wallapatta_20035" class="superScript"><span id="wallapatta_20036" class="text">1</span></sup><span id="wallapatta_20037" class="text"> when you take substrings of a larger string, the larger string is not garbage collected even if it is no longer referenced. The problem seems to be because the substring keeps a reference to the parent string.</span></p></div></div><div id="wallapatta_20009" class="section"><h2 class="heading"><span id="wallapatta_20010" class="block"><a id="wallapatta_20043" class="link" href="<http://vpj.github.io/bench/string_slice.html">Demo</a></span></h2><div class="content"><div id="wallapatta_20011" class="section"><div class="content"><p id="wallapatta_20012" class="paragraph"><span id="wallapatta_20044" class="text">The demo iteratively,</span></p><ol id="wallapatta_20013" class="list"><li id="wallapatta_20014" class="list-item"><span id="wallapatta_20015" class="block"><span id="wallapatta_20045" class="text">creates a random large string (~10M in length)</span></span></li><li id="wallapatta_20016" class="list-item"><span id="wallapatta_20017" class="block"><span id="wallapatta_20046" class="text">take a few substrings (each of about 50 characters)</span></span></li><li id="wallapatta_20018" class="list-item"><span id="wallapatta_20019" class="block"><span id="wallapatta_20047" class="text">push the substrings to a global array (the only thing permanently referenced)</span></span></li><li id="wallapatta_20020" class="list-item"><span id="wallapatta_20021" class="block"><span id="wallapatta_20048" class="text">remove references to the large string</span></span></li></ol></div></div><div id="wallapatta_20022" class="section"><div class="content"><p id="wallapatta_20023" class="paragraph"><span id="wallapatta_20049" class="text">You would assume that larger strings will get garbage collected. And would expect the program to run without a problem for many many iterations - until the memory taken up by the smaller strings hits the limit.</span></p></div></div><div id="wallapatta_20024" class="section"><div class="content"><p id="wallapatta_20025" class="paragraph"><span id="wallapatta_20050" class="text">Unfortunately in Google Chrome it doesn't work like that. The small substrings keep a reference to the parent and therefore it crashes after a few iterations. Try </span><a id="wallapatta_20051" class="link" href="http://vpj.github.io/bench/string_slice.html">http://vpj.github.io/bench/string_slice.html</a><span id="wallapatta_20052" class="text"> in Google Chrome.It crashes before 2000 cycles. </span><sup id="wallapatta_20053" class="superScript"><span id="wallapatta_20054" class="text">2</span></sup><span id="wallapatta_20055" class="text"> If you take a heap snapshot on Chrome Inspector, you can see the large strings, referenced as </span><strong id="wallapatta_20056" class="bold"><span id="wallapatta_20057" class="text">parent in (sliced string)</span></strong><span id="wallapatta_20058" class="text"> by smaller strings (as shown in the above screenshot).</span></p></div></div><div id="wallapatta_20029" class="section"><div class="content"><p id="wallapatta_20030" class="paragraph"><span id="wallapatta_20062" class="text">Then we wrote a copy of the same program, which creates a copy of the substrings before storing them. The following splitting and concatenation creates a actual copy of the string, instead of a reference copy.</span></p><pre id="wallapatta_20031" class="codeBlock"><code class="js">newSmallString = smallString.split(<span class="hljs-string">''</span>).join(<span class="hljs-string">''</span>)</code></pre></div></div><div id="wallapatta_20032" class="section"><div class="content"><p id="wallapatta_20033" class="paragraph"><span id="wallapatta_20063" class="text">Try </span><a id="wallapatta_20064" class="link" href="http://vpj.github.io/bench/string_slice_join.html">http://vpj.github.io/bench/string_slice_join.html</a><span id="wallapatta_20065" class="text">, which will run runs for many more iterations doing the same thing.</span></p></div></div></div></div></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      <div id="wallapatta_20002" class="sidenote"></div><div id="wallapatta_20006" class="sidenote"><div id="wallapatta_20007" class="section"><div class="content"><p id="wallapatta_20008" class="paragraph"><sup id="wallapatta_20038" class="superScript"><span id="wallapatta_20039" class="text">1</span></sup><span id="wallapatta_20040" class="text"> Same happens in </span><a id="wallapatta_20041" class="link" href="https://nodejs.org/en/">node.js</a><span id="wallapatta_20042" class="text"> since it uses V8.</span></p></div></div></div><div id="wallapatta_20026" class="sidenote"><div id="wallapatta_20027" class="section"><div class="content"><p id="wallapatta_20028" class="paragraph"><sup id="wallapatta_20059" class="superScript"><span id="wallapatta_20060" class="text">2</span></sup><span id="wallapatta_20061" class="text"> This only happens in Chrome, not on Safari. Did not check on Firefox.</span></p></div></div></div>
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>&lt;!&gt;
 !img/sliced_string.png

In Google Chrome ^^1^^ when you take substrings of a larger string, the larger string is not garbage collected even if it is no longer referenced. The problem seems to be because the substring keeps a reference to the parent string.

&gt;&gt;&gt;
 ^^1^^ Same happens in &lt;&lt;https://nodejs.org/en/(node.js)&gt;&gt; since it uses V8.

## &lt;&lt;&lt;http://vpj.github.io/bench/string_slice.html(Demo)&gt;&gt;

 The demo iteratively,

  - creates a random large string (~10M in length)
  - take a few substrings (each of about 50 characters)
  - push the substrings to a global array (the only thing permanently referenced)
  - remove references to the large string

 You would assume that larger strings will get garbage collected.
 And would expect the program to run without a problem for many many iterations - until the memory taken up by the smaller strings hits the limit.

 Unfortunately in Google Chrome it doesn't work like that. The small substrings keep a reference to the parent and therefore it crashes after a few iterations.
 Try &lt;&lt;http://vpj.github.io/bench/string_slice.html&gt;&gt; in Google Chrome.It crashes before 2000 cycles. ^^2^^
 If you take a heap snapshot on Chrome Inspector, you can see the large strings, referenced as **parent in (sliced string)** by smaller strings (as shown in the above screenshot).

 &gt;&gt;&gt;
  ^^2^^ This only happens in Chrome, not on Safari. Did not check on Firefox.

 Then we wrote a copy of the same program, which creates a copy of the substrings before storing them. The following splitting and concatenation creates a actual copy of the string, instead of a reference copy.

  ```js
   newSmallString = smallString.split('').join('')

 Try &lt;&lt;http://vpj.github.io/bench/string_slice_join.html&gt;&gt;, which will run runs for many more iterations doing the same thing.</div>
     </div>
    </div>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="weya-perf.html">
      jsblocks, React, Angular performance compared with Weya.coffee
     </a>
    </h1>
    <h3 class="date ">
     May 27, 2015
    </h3>
    <div class="row ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_30000" class="article"><div id="wallapatta_30001" class="section"><div class="content"><p id="wallapatta_30002" class="paragraph"><span id="wallapatta_30048" class="text">I came across </span><a id="wallapatta_30049" class="link" href="http://jsblocks.com/">jsblock</a><span id="wallapatta_30050" class="text"> yesterday on Hacker News. They had a nice performance comparison test case set comparing jsblocks with </span><a id="wallapatta_30051" class="link" href="https://angularjs.org/">Angular</a><span id="wallapatta_30052" class="text"> and </span><a id="wallapatta_30053" class="link" href="https://facebook.github.io/react/">React</a><span id="wallapatta_30054" class="text">. It made me curious to see how the small library we use (</span><a id="wallapatta_30055" class="link" href="https://github.com/vpj/weya">Weya.coffee</a><span id="wallapatta_30056" class="text">) compares in performance with these.</span></p></div></div><div id="wallapatta_30007" class="section"><div class="content"><p id="wallapatta_30008" class="paragraph"><span id="wallapatta_30060" class="text">I ran the tests on Chrome broswer on a Macbook Air (1.6Ghz i5, 2GB). I have not altered test cases provided on </span><a id="wallapatta_30061" class="link" href="http://jsblocks.com/">jsblock</a><span id="wallapatta_30062" class="text">, and have added test cases for Weya for </span><strong id="wallapatta_30063" class="bold"><span id="wallapatta_30064" class="text">Rendering</span></strong><span id="wallapatta_30065" class="text"> and </span><strong id="wallapatta_30066" class="bold"><span id="wallapatta_30067" class="text">Syncing Changes</span></strong><span id="wallapatta_30068" class="text">., The results on Safari are not accurate in </span><em id="wallapatta_30069" class="italics"><span id="wallapatta_30070" class="text">syncing-changes</span></em><span id="wallapatta_30071" class="text"> test case, because jsblock test case use </span><code id="wallapatta_30072" class="code"><span id="wallapatta_30073" class="text">setTimeout(0)</span></code><span id="wallapatta_30074" class="text"> to resync which is called before html is actually rendered while the Weya test case use </span><code id="wallapatta_30075" class="code"><span id="wallapatta_30076" class="text">requestAnimationFrame</span></code><span id="wallapatta_30077" class="text"> which waits till it's rendered.</span></p></div></div><div id="wallapatta_30012" class="section"><h3 class="heading"><span id="wallapatta_30013" class="block"><span id="wallapatta_30080" class="text">Rendering</span></span></h3><div class="content"><table id="wallapatta_30014" class="table"><thead><tr><th colspan="1"><span id="wallapatta_30015" class="block"><span id="wallapatta_30081" class="text">Library</span></span></th><th colspan="1"><span id="wallapatta_30016" class="block"><span id="wallapatta_30082" class="text">Time (ms)</span></span></th><th colspan="1"><span id="wallapatta_30017" class="block"><span id="wallapatta_30083" class="text">Bar (shorter is better)</span></span></th></tr></thead><tbody><tr><td colspan="1"><span id="wallapatta_30018" class="block"><span id="wallapatta_30084" class="text">Weya.coffee</span></span></td><td colspan="1"><span id="wallapatta_30019" class="block"><span id="wallapatta_30085" class="text">404</span></span></td><td colspan="1"><span id="wallapatta_30020" class="block"><span id="wallapatta_30086" class="text">====</span></span></td></tr><tr><td colspan="1"><span id="wallapatta_30021" class="block"><span id="wallapatta_30087" class="text">jsblocks</span></span></td><td colspan="1"><span id="wallapatta_30022" class="block"><span id="wallapatta_30088" class="text">801</span></span></td><td colspan="1"><span id="wallapatta_30023" class="block"><span id="wallapatta_30089" class="text">========</span></span></td></tr><tr><td colspan="1"><span id="wallapatta_30024" class="block"><span id="wallapatta_30090" class="text">React</span></span></td><td colspan="1"><span id="wallapatta_30025" class="block"><span id="wallapatta_30091" class="text">1065</span></span></td><td colspan="1"><span id="wallapatta_30026" class="block"><span id="wallapatta_30092" class="text">==========</span></span></td></tr><tr><td colspan="1"><span id="wallapatta_30027" class="block"><span id="wallapatta_30093" class="text">Angular</span></span></td><td colspan="1"><span id="wallapatta_30028" class="block"><span id="wallapatta_30094" class="text">2432</span></span></td><td colspan="1"><span id="wallapatta_30029" class="block"><span id="wallapatta_30095" class="text">========================</span></span></td></tr></tbody></table></div></div><div id="wallapatta_30030" class="section"><h3 class="heading"><span id="wallapatta_30031" class="block"><span id="wallapatta_30096" class="text">Syncing Changes</span></span></h3><div class="content"><table id="wallapatta_30032" class="table"><thead><tr><th colspan="1"><span id="wallapatta_30033" class="block"><span id="wallapatta_30097" class="text">Library</span></span></th><th colspan="1"><span id="wallapatta_30034" class="block"><span id="wallapatta_30098" class="text">Time (ms)</span></span></th><th colspan="1"><span id="wallapatta_30035" class="block"><span id="wallapatta_30099" class="text">Bar (shorter is better)</span></span></th></tr></thead><tbody><tr><td colspan="1"><span id="wallapatta_30036" class="block"><span id="wallapatta_30100" class="text">Weya.coffee</span></span></td><td colspan="1"><span id="wallapatta_30037" class="block"><span id="wallapatta_30101" class="text">1593</span></span></td><td colspan="1"><span id="wallapatta_30038" class="block"><span id="wallapatta_30102" class="text">========</span></span></td></tr><tr><td colspan="1"><span id="wallapatta_30039" class="block"><span id="wallapatta_30103" class="text">jsblocks</span></span></td><td colspan="1"><span id="wallapatta_30040" class="block"><span id="wallapatta_30104" class="text">2035</span></span></td><td colspan="1"><span id="wallapatta_30041" class="block"><span id="wallapatta_30105" class="text">==========</span></span></td></tr><tr><td colspan="1"><span id="wallapatta_30042" class="block"><span id="wallapatta_30106" class="text">React</span></span></td><td colspan="1"><span id="wallapatta_30043" class="block"><span id="wallapatta_30107" class="text">2781</span></span></td><td colspan="1"><span id="wallapatta_30044" class="block"><span id="wallapatta_30108" class="text">==============</span></span></td></tr><tr><td colspan="1"><span id="wallapatta_30045" class="block"><span id="wallapatta_30109" class="text">Angular</span></span></td><td colspan="1"><span id="wallapatta_30046" class="block"><span id="wallapatta_30110" class="text">8081</span></span></td><td colspan="1"><span id="wallapatta_30047" class="block"><span id="wallapatta_30111" class="text">========================================</span></span></td></tr></tbody></table></div></div></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      <div id="wallapatta_30003" class="sidenote"><div id="wallapatta_30004" class="section"><div class="content"><p id="wallapatta_30005" class="paragraph"><span id="wallapatta_30057" class="text">Weya.coffee is more of a rendering tool than a a framework. The main difference between Weya and other frameworks is that instead of writing logic inside html, markup is written in coffeescript. Weya comes with a router and a base class inspired by </span><a id="wallapatta_30058" class="link" href="http://backbonejs.org/">backbone.js</a><span id="wallapatta_30059" class="text">.</span></p></div></div><div id="wallapatta_30006" class="html"><iframe src="https://ghbtns.com/github-btn.html?user=vpj&amp;repo=weya&amp;type=star&amp;count=true&amp;size=large" frameborder="0" scrolling="0" width="160px" height="30px"></iframe>
</div></div><div id="wallapatta_30009" class="sidenote"><div id="wallapatta_30010" class="section"><div class="content"><p id="wallapatta_30011" class="paragraph"><strong id="wallapatta_30078" class="bold"><a id="wallapatta_30079" class="link" href="http://vpj.github.io/jsblocks-performance.zip">Download the performance test cases</a></strong></p></div></div></div>
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>I came across &lt;&lt;http://jsblocks.com/(jsblock)&gt;&gt; yesterday on Hacker News. They had a nice performance comparison test case set comparing jsblocks with &lt;&lt;https://angularjs.org/(Angular)&gt;&gt; and &lt;&lt;https://facebook.github.io/react/(React)&gt;&gt;. It made me curious to see how the small library we use (&lt;&lt;https://github.com/vpj/weya(Weya.coffee)&gt;&gt;) compares in performance with these.

&gt;&gt;&gt;
 Weya.coffee is more of a rendering tool than a a framework. The main difference between Weya and other frameworks is that instead of writing logic inside html, markup is written in coffeescript. Weya comes with a router and a base class inspired by &lt;&lt;http://backbonejs.org/(backbone.js)&gt;&gt;.

 &lt;&lt;&lt;
  &lt;iframe src="https://ghbtns.com/github-btn.html?user=vpj&repo=weya&type=star&count=true&size=large" frameborder="0" scrolling="0" width="160px" height="30px"&gt;&lt;/iframe&gt;

I ran the tests on Chrome broswer on a Macbook Air (1.6Ghz i5, 2GB). I have not altered test cases provided on &lt;&lt;http://jsblocks.com/(jsblock)&gt;&gt;, and have added test cases for Weya for **Rendering** and **Syncing Changes**., The results on Safari are not accurate in --syncing-changes-- test case, because jsblock test case use ``setTimeout(0)`` to resync which is called before html is actually rendered while the Weya test case use ``requestAnimationFrame`` which waits till it's rendered.

&gt;&gt;&gt;
 **&lt;&lt;http://vpj.github.io/jsblocks-performance.zip(Download the performance test cases)&gt;&gt;


### Rendering

 |||
  Library | Time (ms) |Bar (shorter is better)
  ===
  Weya.coffee | 404 | ====
  jsblocks | 801 | ========
  React | 1065 | ==========
  Angular | 2432 | ========================

### Syncing Changes

 |||
  Library | Time (ms) | Bar (shorter is better)
  ===
  Weya.coffee | 1593 | ========
  jsblocks | 2035 | ==========
  React | 2781 | ==============
  Angular | 8081 | ========================================

</div>
     </div>
    </div>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="cellular-start.html">
      Small data preparation
     </a>
    </h1>
    <h3 class="date ">
     May 24, 2015
    </h3>
    <div class="row ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_40000" class="article"><div id="wallapatta_40001" class="html"><iframe width="550" height="310" src="https://www.youtube.com/embed/AcSIzSQIDQ8?autoplay=0" frameborder="0" allowfullscreen=""></iframe>
</div><div id="wallapatta_40005" class="section"><div class="content"><p id="wallapatta_40006" class="paragraph"><span id="wallapatta_40020" class="text">One of the biggest </span><strong id="wallapatta_40021" class="bold"><span id="wallapatta_40022" class="text">small data</span></strong><span id="wallapatta_40023" class="text"> problems, is that data is structured in different ways. Some legacy systems give out reports in the formats like below.</span></p></div></div><pre id="wallapatta_40007" class="codeBlock"><code class="nohighlight">SUPPLIER STATEMENT                         38 November 2011

Supplier   B0001   SupplierX Corp
                   51, AAA STREET, BBB
===========================================================
DATE     REF.No.        DESCRIPTION       DEBIT      CREDIT
===========================================================
01/04/10                Balance B/F                1,000.00

01/05/10 AAAA-00001     PAYMENT          500,00
01/06/10 AAAA-00002     PAYMENT          250.00

01/07/10 IIII-00001     INVOICE                    2,000.00
                                      ---------  ----------
                                         750.00    3,000.00

31/03/11                Balance C/F                2,250.00

Contd. ......


SUPPLIER STATEMENT                         38 November 2011

Supplier   B0002   SupplierY Corp
                   51, ACD STREET, BBB
===========================================================
DATE     REF.No.        DESCRIPTION       DEBIT      CREDIT
===========================================================
01/04/10                Balance B/F                1,500.00

01/05/10 AAAA-00003     PAYMENT        1,500,00

01/07/10 IIII-00002     INVOICE                    2,000.00
01/08/10 IIII-00003     INVOICE                    1,000.00
                                      ---------  ----------
                                       1,500.00    4,500.00

31/03/11                Balance C/F                3,500.00

Contd. ......</code></pre><div id="wallapatta_40008" class="section"><div class="content"><p id="wallapatta_40009" class="paragraph"><span id="wallapatta_40024" class="text">Getting this into a spreadsheet or a database table to analyse it is not easy. So I started a project to help transform data in various report formats into simple tables and export as comma-separated files.</span></p></div></div><div id="wallapatta_40010" class="section"><div class="content"><p id="wallapatta_40011" class="paragraph"><span id="wallapatta_40025" class="text">The project is called </span><strong id="wallapatta_40026" class="bold"><a id="wallapatta_40027" class="link" href="http://vpj.github.io/cellular/">cellular</a></strong><span id="wallapatta_40028" class="text">, and it is still in the early stages. I thought of writing about it to get ideas and suggestions. It has a simple user interface with the table on the left side with a sidepane on right side.</span></p></div></div></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      <div id="wallapatta_40002" class="sidenote"><div id="wallapatta_40003" class="section"><div class="content"><p id="wallapatta_40004" class="paragraph"><span id="wallapatta_40016" class="text">Here's a small screen cast of using </span><strong id="wallapatta_40017" class="bold"><span id="wallapatta_40018" class="text">cellular</span></strong><span id="wallapatta_40019" class="text"> to transform the below report.</span></p></div></div></div><div id="wallapatta_40012" class="sidenote"><div id="wallapatta_40013" class="html"><iframe src="https://ghbtns.com/github-btn.html?user=vpj&amp;repo=cellular&amp;type=star&amp;count=true&amp;size=large" frameborder="0" scrolling="0" width="160px" height="30px"></iframe>
</div><div id="wallapatta_40014" class="section"><h3 class="heading"><span id="wallapatta_40015" class="block"><strong id="wallapatta_40029" class="bold"><a id="wallapatta_40030" class="link" href="http://vpj.github.io/cellular/">demo</a></strong></span></h3><div class="content"></div></div></div>
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>&lt;&lt;&lt;
 &lt;iframe width="550" height="310" src="https://www.youtube.com/embed/AcSIzSQIDQ8?autoplay=0" frameborder="0" allowfullscreen&gt;&lt;/iframe&gt;

&gt;&gt;&gt;
 Here's a small screen cast of using **cellular** to transform the below report.

One of the biggest **small data** problems, is that data is structured in different ways. Some legacy systems give out reports in the formats like below.

```
 SUPPLIER STATEMENT                         38 November 2011

 Supplier   B0001   SupplierX Corp
                    51, AAA STREET, BBB
 ===========================================================
 DATE     REF.No.        DESCRIPTION       DEBIT      CREDIT
 ===========================================================
 01/04/10                Balance B/F                1,000.00

 01/05/10 AAAA-00001     PAYMENT          500,00
 01/06/10 AAAA-00002     PAYMENT          250.00

 01/07/10 IIII-00001     INVOICE                    2,000.00
                                       ---------  ----------
                                          750.00    3,000.00

 31/03/11                Balance C/F                2,250.00

 Contd. ......


 SUPPLIER STATEMENT                         38 November 2011

 Supplier   B0002   SupplierY Corp
                    51, ACD STREET, BBB
 ===========================================================
 DATE     REF.No.        DESCRIPTION       DEBIT      CREDIT
 ===========================================================
 01/04/10                Balance B/F                1,500.00

 01/05/10 AAAA-00003     PAYMENT        1,500,00

 01/07/10 IIII-00002     INVOICE                    2,000.00
 01/08/10 IIII-00003     INVOICE                    1,000.00
                                       ---------  ----------
                                        1,500.00    4,500.00

 31/03/11                Balance C/F                3,500.00

 Contd. ......

///This is what SAP exports look like.


Getting this into a spreadsheet or a database table to analyse it is not easy. So I started a project to help transform data in various report formats into simple tables and export as comma-separated files.

The project is called **&lt;&lt;http://vpj.github.io/cellular/(cellular)&gt;&gt;**, and it is still in the early stages. I thought of writing about it to get ideas and suggestions. It has a simple user interface with the table on the left side with a sidepane on right side.

&gt;&gt;&gt;
 &lt;&lt;&lt;
  &lt;iframe src="https://ghbtns.com/github-btn.html?user=vpj&repo=cellular&type=star&count=true&size=large" frameborder="0" scrolling="0" width="160px" height="30px"&gt;&lt;/iframe&gt;

 ###**&lt;&lt;http://vpj.github.io/cellular/(demo)&gt;&gt;**

</div>
     </div>
    </div>
   </div>
   <div class="wallapatta ">
    <h1 class="title ">
     <a href="wallapatta.html">
      Wallapatta Blog
     </a>
    </h1>
    <h3 class="date ">
     May 18, 2015
    </h3>
    <div class="row ">
     <div class="wallapatta-main nine columns ">
      <div id="wallapatta_50000" class="article"><div id="wallapatta_50001" class="section"><div class="content"><p id="wallapatta_50002" class="paragraph"><span id="wallapatta_50081" class="text">I just started moving my blog from </span><a id="wallapatta_50082" class="link" href="http://svbtle.com">Svbtle</a><span id="wallapatta_50083" class="text"> to a static blog generated that I created. It is based on </span><a id="wallapatta_50084" class="link" href="http://vpj.github.io/wallapatta/introduction.html">Wallapatta</a><span id="wallapatta_50085" class="text">. I wanted to get into svbtle when </span><a id="wallapatta_50086" class="link" href="http://dcurt.is/codename-svbtle">Dustin started it</a><span id="wallapatta_50087" class="text">, and got invite a little before they opened it to the public. And it's sad to part ways.</span></p></div></div><div id="wallapatta_50006" class="section"><div class="content"><p id="wallapatta_50007" class="paragraph"><span id="wallapatta_50093" class="text">Wallapatta is a </span><a id="wallapatta_50094" class="link" href="http://en.wikipedia.org/wiki/Markdown">Markdown</a><span id="wallapatta_50095" class="text"> like syntax that can create documents with layouts inspired by handouts of Edward R. Tufte</span><sup id="wallapatta_50096" class="superScript"><span id="wallapatta_50097" class="text">1</span></sup><span id="wallapatta_50098" class="text">. We created it to use for documents. The two great things about Wallapatta is that it creates documents with </span><strong id="wallapatta_50099" class="bold"><span id="wallapatta_50100" class="text">sidenotes</span></strong><span id="wallapatta_50101" class="text"> and </span><strong id="wallapatta_50102" class="bold"><span id="wallapatta_50103" class="text">create print frindly documents</span></strong><span id="wallapatta_50104" class="text"> - </span><a id="wallapatta_50105" class="link" href="http://vpj.github.io/wallapatta/introduction.html">Wallapatta editor</a><span id="wallapatta_50106" class="text"> creates print layouts with intelligent page breaks by trying not to place breaks at middle of content like most word processing software do.</span></p></div></div><div id="wallapatta_50011" class="section"><div class="content"><p id="wallapatta_50012" class="paragraph"><span id="wallapatta_50111" class="text">I built in a simple blog generator into Wallapatta, for personal use. But it's super easy for anyone who wants to give it a go.</span></p></div></div><div id="wallapatta_50013" class="section"><h3 class="heading"><span id="wallapatta_50014" class="block"><span id="wallapatta_50112" class="text">How to start a Wallapatta blog?</span></span></h3><div class="content"><div id="wallapatta_50017" class="section"><div class="content"><p id="wallapatta_50018" class="paragraph"><span id="wallapatta_50113" class="text">It's pretty easy.</span></p></div></div><ol id="wallapatta_50019" class="list"><li id="wallapatta_50020" class="list-item"><span id="wallapatta_50021" class="block"><strong id="wallapatta_50114" class="bold"><span id="wallapatta_50115" class="text">Install </span><a id="wallapatta_50116" class="link" href="https://nodejs.org/">Node.js</a></strong></span><div id="wallapatta_50022" class="section"><div class="content"><p id="wallapatta_50023" class="paragraph"><span id="wallapatta_50117" class="text">NPM usually comes with Node.js. Visit </span><a id="wallapatta_50118" class="link" href="https://nodejs.org/">https://nodejs.org/</a><span id="wallapatta_50119" class="text"> and see installation instructions. It's usually a download and install, unless you want it installed through a package manager like </span><code id="wallapatta_50120" class="code"><span id="wallapatta_50121" class="text">brew</span></code><span id="wallapatta_50122" class="text">.</span></p></div></div></li><li id="wallapatta_50024" class="list-item"><span id="wallapatta_50025" class="block"><strong id="wallapatta_50123" class="bold"><span id="wallapatta_50124" class="text">Install </span><a id="wallapatta_50125" class="link" href="https://www.npmjs.com/package/wallapatta">Wallapatta node odule</a></strong></span><div id="wallapatta_50026" class="section"><div class="content"><p id="wallapatta_50027" class="paragraph"><span id="wallapatta_50126" class="text">Run the following command in command line.</span></p></div></div><pre id="wallapatta_50028" class="codeBlock"><code class="nohighlight">npm install wallapatta -g</code></pre><div id="wallapatta_50029" class="section"><div class="content"><p id="wallapatta_50030" class="paragraph"><span id="wallapatta_50127" class="text">That's it and you have wallapatta installed.</span></p></div></div></li><li id="wallapatta_50031" class="list-item"><span id="wallapatta_50032" class="block"><strong id="wallapatta_50128" class="bold"><span id="wallapatta_50129" class="text">Fork the </span><a id="wallapatta_50130" class="link" href="https://github.com/vpj/wallapatta-blog-boilerplate">boilerplate</a></strong></span><div id="wallapatta_50033" class="section"><div class="content"><p id="wallapatta_50034" class="paragraph"><span id="wallapatta_50131" class="text">Make a fork of the git repositors on github: </span><a id="wallapatta_50132" class="link" href="https://github.com/vpj/wallapatta-blog-boilerplate">https://github.com/vpj/wallapatta-blog-boilerplate</a></p></div></div><div id="wallapatta_50035" class="section"><div class="content"><p id="wallapatta_50036" class="paragraph"><span id="wallapatta_50133" class="text">This repo contains this blog post, and 3 empty blog posts, a configuration file and templates for blog.</span></p></div></div><div id="wallapatta_50037" class="section"><div class="content"><p id="wallapatta_50038" class="paragraph"><span id="wallapatta_50134" class="text">Edit </span><code id="wallapatta_50135" class="code"><span id="wallapatta_50136" class="text">templates/post.coffee</span></code><span id="wallapatta_50137" class="text"> to change the post template and </span><code id="wallapatta_50138" class="code"><span id="wallapatta_50139" class="text">templates/blog.coffee</span></code><span id="wallapatta_50140" class="text"> to change the blog template. Compile these </span><a id="wallapatta_50141" class="link" href="http://coffeescript.org/">coffeescript</a><span id="wallapatta_50142" class="text"> code to javascript by running </span><code id="wallapatta_50143" class="code"><span id="wallapatta_50144" class="text">coffee -c *</span></code><span id="wallapatta_50145" class="text">.</span></p></div></div><div id="wallapatta_50039" class="section"><div class="content"><p id="wallapatta_50040" class="paragraph"><span id="wallapatta_50146" class="text">You will have to change the name of the blog, which is "Varuna Jayasiri" in the two tamplate files. And also the Google Analytics code.</span></p></div></div><div id="wallapatta_50041" class="section"><div class="content"><p id="wallapatta_50042" class="paragraph"><span id="wallapatta_50147" class="text">Change </span><code id="wallapatta_50148" class="code"><span id="wallapatta_50149" class="text">blog.yaml</span></code><span id="wallapatta_50150" class="text"> to edit blog configurations like the order of posts, post titles, dates, etc.</span></p></div></div></li><li id="wallapatta_50043" class="list-item"><span id="wallapatta_50044" class="block"><strong id="wallapatta_50151" class="bold"><span id="wallapatta_50152" class="text">Generate the blog</span></strong></span><pre id="wallapatta_50045" class="codeBlock"><code class="nohighlight">wallapatta --blog blog.yaml --output [output_directory] --static</code></pre><div id="wallapatta_50046" class="section"><div class="content"><p id="wallapatta_50047" class="paragraph"><span id="wallapatta_50153" class="text">The above command will create the html files on the </span><code id="wallapatta_50154" class="code"><span id="wallapatta_50155" class="text">output_directory</span></code><span id="wallapatta_50156" class="text"> provided. </span><code id="wallapatta_50157" class="code"><span id="wallapatta_50158" class="text">--static</span></code><span id="wallapatta_50159" class="text"> specifies that it should copy Wallapatta rendering tools to the folder. (You can omit this if you change the templates to get these from a CDN).</span></p></div></div><div id="wallapatta_50048" class="section"><div class="content"><p id="wallapatta_50049" class="paragraph"><code id="wallapatta_50160" class="code"><span id="wallapatta_50161" class="text">blog.css</span></code><span id="wallapatta_50162" class="text"> file on the boilerplate repository contains some css. This file is used in default templates. So you need to copy them to the </span><code id="wallapatta_50163" class="code"><span id="wallapatta_50164" class="text">output_directory</span></code><span id="wallapatta_50165" class="text">.</span></p></div></div></li><li id="wallapatta_50050" class="list-item"><span id="wallapatta_50051" class="block"><strong id="wallapatta_50166" class="bold"><span id="wallapatta_50167" class="text">That is it!</span></strong></span></li></ol></div></div><div id="wallapatta_50052" class="section"><h3 class="heading"><span id="wallapatta_50053" class="block"><span id="wallapatta_50168" class="text">What is Wallapatta syntax?</span></span></h3><div class="content"><div id="wallapatta_50054" class="section"><div class="content"><p id="wallapatta_50055" class="paragraph"><span id="wallapatta_50169" class="text">It looks like this.</span></p></div></div><pre id="wallapatta_50056" class="codeBlock"><code class="nohighlight">###Heading 1

 Introduction to **Heading 1**

 * Point one

  Description about point one

 * Point two

 ####Subtopic

  Subtopic content

 This belongs to Heading 1</code></pre><div id="wallapatta_50075" class="section"><div class="content"><p id="wallapatta_50076" class="paragraph"><span id="wallapatta_50180" class="text">It uses indentation to identify what belong where. Indentation is required for specifying content for components like lists, code blocks, special blocks, etc as well. So it's more of a programmer friendly syntax. Indentation helps while working with large documents because you can do stuff like </span><strong id="wallapatta_50181" class="bold"><span id="wallapatta_50182" class="text">code folding</span></strong><span id="wallapatta_50183" class="text">.</span></p></div></div><div id="wallapatta_50077" class="section"><div class="content"><p id="wallapatta_50078" class="paragraph"><span id="wallapatta_50184" class="text">We've changed some of the syntax from Markdown; for instance, </span><code id="wallapatta_50185" class="code"><span id="wallapatta_50186" class="text">&lt;&lt;</span></code><span id="wallapatta_50187" class="text"> and </span><code id="wallapatta_50188" class="code"><span id="wallapatta_50189" class="text">&gt;&gt;</span></code><span id="wallapatta_50190" class="text"> are used for links instead of </span><code id="wallapatta_50191" class="code"><span id="wallapatta_50192" class="text">[]()</span></code><span id="wallapatta_50193" class="text">, because we felt that it's a little more intuitive due to its resemblence with HTML tags.</span></p></div></div><div id="wallapatta_50079" class="section"><div class="content"><p id="wallapatta_50080" class="paragraph"><a id="wallapatta_50194" class="link" href="http://vpj.github.io/wallapatta/reference.html">Read the Wallapatta reference</a><span id="wallapatta_50195" class="text"> for a detailed description on each component, including examples for usage.</span></p></div></div></div></div></div>
     </div>
     <div class="wallapatta-sidebar three columns ">
      <div id="wallapatta_50003" class="sidenote"><div id="wallapatta_50004" class="section"><div class="content"><p id="wallapatta_50005" class="paragraph"><span id="wallapatta_50088" class="text">"Wallapatta" is a </span><a id="wallapatta_50089" class="link" href="http://www.dwc.gov.lk/index.php/en/wildlife-news1/228-walla-patta-gyrinops-walla-the-tree-to-preserv">tree in Sri Lanka</a><span id="wallapatta_50090" class="text">, that contains </span><a id="wallapatta_50091" class="link" href="http://en.wikipedia.org/wiki/Agarwood">Agarwood</a><span id="wallapatta_50092" class="text">.</span></p></div></div></div><div id="wallapatta_50008" class="sidenote"><div id="wallapatta_50009" class="section"><div class="content"><p id="wallapatta_50010" class="paragraph"><sup id="wallapatta_50107" class="superScript"><span id="wallapatta_50108" class="text">1</span></sup><span id="wallapatta_50109" class="text"> </span><a id="wallapatta_50110" class="link" href="http://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=0000hB">Book design: advice and examples - edwardtufte.com</a></p></div></div></div><div id="wallapatta_50015" class="sidenote"><div id="wallapatta_50016" class="html"><iframe src="https://ghbtns.com/github-btn.html?user=vpj&amp;repo=wallapatta&amp;type=star&amp;count=true&amp;size=large" frameborder="0" scrolling="0" width="160px" height="30px"></iframe>

</div></div><div id="wallapatta_50057" class="sidenote"><div id="wallapatta_50058" class="section"><h3 class="heading"><span id="wallapatta_50059" class="block"><span id="wallapatta_50170" class="text">Heading 1</span></span></h3><div class="content"><div id="wallapatta_50060" class="section"><div class="content"><p id="wallapatta_50061" class="paragraph"><span id="wallapatta_50171" class="text">Introduction to </span><strong id="wallapatta_50172" class="bold"><span id="wallapatta_50173" class="text">Heading 1</span></strong></p></div></div><ul id="wallapatta_50062" class="list"><li id="wallapatta_50063" class="list-item"><span id="wallapatta_50064" class="block"><span id="wallapatta_50174" class="text">Point one</span></span><div id="wallapatta_50065" class="section"><div class="content"><p id="wallapatta_50066" class="paragraph"><span id="wallapatta_50175" class="text">Description about point one</span></p></div></div></li><li id="wallapatta_50067" class="list-item"><span id="wallapatta_50068" class="block"><span id="wallapatta_50176" class="text">Point two</span></span></li></ul><div id="wallapatta_50069" class="section"><h4 class="heading"><span id="wallapatta_50070" class="block"><span id="wallapatta_50177" class="text">Subtopic</span></span></h4><div class="content"><div id="wallapatta_50071" class="section"><div class="content"><p id="wallapatta_50072" class="paragraph"><span id="wallapatta_50178" class="text">Subtopic content</span></p></div></div></div></div><div id="wallapatta_50073" class="section"><div class="content"><p id="wallapatta_50074" class="paragraph"><span id="wallapatta_50179" class="text">This belongs to Heading 1</span></p></div></div></div></div></div>
     </div>
     <div style="display:none;">
      <div class='wallapatta-code'>I just started moving my blog from &lt;&lt;http://svbtle.com(Svbtle)&gt;&gt; to a static blog generated that I created. It is based on &lt;&lt;http://vpj.github.io/wallapatta/introduction.html(Wallapatta)&gt;&gt;. I wanted to get into svbtle when &lt;&lt;http://dcurt.is/codename-svbtle(Dustin started it)&gt;&gt;, and got invite a little before they opened it to the public. And it's sad to part ways.

&gt;&gt;&gt;
 "Wallapatta" is a &lt;&lt;http://www.dwc.gov.lk/index.php/en/wildlife-news1/228-walla-patta-gyrinops-walla-the-tree-to-preserv(tree in Sri Lanka)&gt;&gt;, that contains &lt;&lt;http://en.wikipedia.org/wiki/Agarwood(Agarwood)&gt;&gt;.



Wallapatta is a
&lt;&lt;http://en.wikipedia.org/wiki/Markdown(Markdown)&gt;&gt; like syntax that can create documents with layouts
inspired by handouts of Edward R. Tufte^^1^^. We created it to use for documents. The two great things about Wallapatta is that it creates documents with **sidenotes** and **create print frindly documents** - &lt;&lt;http://vpj.github.io/wallapatta/introduction.html(Wallapatta editor)&gt;&gt; creates print layouts with intelligent page breaks by trying not to place breaks at middle of content like most word processing software do.

 &gt;&gt;&gt;
  ^^1^^ &lt;&lt;http://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=0000hB
  (Book design: advice and examples - edwardtufte.com)&gt;&gt;

I built in a simple blog generator into Wallapatta, for personal use. But it's super easy for anyone who wants to give it a go.

###How to start a Wallapatta blog?

 &gt;&gt;&gt;
  &lt;&lt;&lt;
   &lt;iframe src="https://ghbtns.com/github-btn.html?user=vpj&repo=wallapatta&type=star&count=true&size=large" frameborder="0" scrolling="0" width="160px" height="30px"&gt;&lt;/iframe&gt;


 It's pretty easy.

 - **Install &lt;&lt;https://nodejs.org/(Node.js&gt;&gt;

  NPM usually comes with Node.js. Visit &lt;&lt;https://nodejs.org/&gt;&gt; and see installation instructions. It's usually a download and install, unless you want it installed through a package manager like ``brew``.

 - **Install &lt;&lt;https://www.npmjs.com/package/wallapatta(Wallapatta node odule&gt;&gt;

  Run the following command in command line.

  ```
   npm install wallapatta -g

  That's it and you have wallapatta installed.

 - **Fork the &lt;&lt;https://github.com/vpj/wallapatta-blog-boilerplate(boilerplate)&gt;&gt;

  Make a fork of the git repositors on github: &lt;&lt;https://github.com/vpj/wallapatta-blog-boilerplate&gt;&gt;

  This repo contains this blog post, and 3 empty blog posts, a configuration file and templates for blog.

  Edit ``templates/post.coffee`` to change the post template and ``templates/blog.coffee`` to change the blog template. Compile these &lt;&lt;http://coffeescript.org/(coffeescript&gt;&gt; code to javascript by running ``coffee -c *``.

  You will have to change the name of the blog, which is "Varuna Jayasiri" in the two tamplate files. And also the Google Analytics code.

  Change ``blog.yaml`` to edit blog configurations like the order of posts, post titles, dates, etc.

 - **Generate the blog

  ```
   wallapatta --blog blog.yaml --output [output_directory] --static

  The above command will create the html files on the ``output_directory`` provided. ``--static`` specifies that it should copy Wallapatta rendering tools to the folder. (You can omit this if you change the templates to get these from a CDN).

  ``blog.css`` file on the boilerplate repository contains some css. This file is used in default templates. So you need to copy them to the ``output_directory``.

 - **That is it!


###What is Wallapatta syntax?

 It looks like this.

 ```
  ###Heading 1

   Introduction to **Heading 1**

   * Point one

    Description about point one

   * Point two

   ####Subtopic

    Subtopic content

   This belongs to Heading 1

 &gt;&gt;&gt;
  ###Heading 1

   Introduction to **Heading 1**

   * Point one

    Description about point one

   * Point two

   ####Subtopic

    Subtopic content

   This belongs to Heading 1

 It uses indentation to identify what belong where. Indentation is required for specifying content for components like lists, code blocks, special blocks, etc as well. So it's more of a programmer friendly syntax. Indentation helps while working with large documents because you can do stuff like **code folding**.

 We've changed some of the syntax from Markdown; for instance, ``&lt;&lt;`` and ``&gt;&gt;`` are used for links instead of ``[]()``, because we felt that it's a little more
 intuitive due to its resemblence with HTML tags.

 &lt;&lt;http://vpj.github.io/wallapatta/reference.html(Read the Wallapatta reference)&gt;&gt; for a detailed description on each component, including examples for usage.
</div>
     </div>
    </div>
   </div>
   <div class="paginate ">
    <a class="next-page button " href="page2.html">
     next
    </a>
   </div>
  </div>
  <script src="lib/highlightjs/highlight.pack.js">
  </script>
  <script src="lib/weya/weya.js">
  </script>
  <script src="lib/weya/base.js">
  </script>
  <script src="lib/mod/mod.js">
  </script>
  <script src="js/static.js?v=9">
  </script>
  <script src="js/parser.js?v=9">
  </script>
  <script src="js/reader.js?v=9">
  </script>
  <script src="js/nodes.js?v=9">
  </script>
  <script src="js/render.js?v=9">
  </script>
 </body>
</html>
